webpackJsonp([1],{0:function(e,t){},"0byE":function(e,t){},"0xVi":function(e,t){},"23xk":function(e,t){},"28BC":function(e,t,s){e.exports=s.p+"static/img/mainbg.2998913.jpg"},"9hU/":function(e,t){},BNMO:function(e,t){},DCDw:function(e,t){},EVuS:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAIAAACRXR/mAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyBpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBXaW5kb3dzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOkQ5NUQ1RTlEMjc5MzExRThBMjBBRTk2QjREMDYzODdCIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOkQ5NUQ1RTlFMjc5MzExRThBMjBBRTk2QjREMDYzODdCIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6RDk1RDVFOUIyNzkzMTFFOEEyMEFFOTZCNEQwNjM4N0IiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6RDk1RDVFOUMyNzkzMTFFOEEyMEFFOTZCNEQwNjM4N0IiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz7CNuTkAAACmElEQVR42uyZy2sTURTGv0zalJJixVIpBl+tUB9UpQa3LqQLwZUIutGV4MaVK0HBjf4BhaJQChaFgiAuRFAQA4IbpdZHsRqpLVaFkGg1oXH6cBq/IdBV52bunTlDkHzrmXN/c+693zn3TqxSqaD+ZKEu1cBqYDWw/h8sexWTf8LEagry8p0Cxn7gWcnFqqqrGQMbcaELh9sCYcXMXP7lAs7P4E3Z84FTHbjRjU1NEWIxSWRay5CXtrXg0R7sbY0E60kRxz7A8fdSKoHX+9HZLLzk5//i9Ce/TNT3ZZydlt+J17+5ZFp6/NtNsCAWkzRaMPn0mzlJrExJO1VrCVuuiGFNmRom9+zsohhWYcXcHrn267EmJiwxLNqjsWhgUlgsdmbi9+xsEcNi6INJEyzWR1k7vZzSHqAtjotbhLFOdmCgXW+Aa1vdbke8VBcdpN9h2p8PnenE7V2RdKftcbzow5ENtZ+8lMKtnmjbQNbH4Tyufl3fYw8kMbjDF3rIdspGeazg6ftvy7gyh0zRHEs7WwsOzn3G3Z9+rWGkx92MslhZGyeymLI1BmDTfL8Xva1iWJy44x/dbBlY18PdekvNL9arMo6+d93BTNy/T/fhUDJULC7t9CTmlgI1EayM431+jxu+diLXeEAmihEYJzSD4KZ78CucrotxfG7hGpPIHrx7Qru3VDdeM/1IxIJlaygXJlO1ex7KBcsWK8z2iZCxqgn70o94zDRb9+bDZ6omjJHNJ3E0L3XiqBnZcxJ5Ut08rnHdoCXOYD6tumayFEdhR+z/BiMzvskkPi/JnhzV8S1FYRZVxgDLXkV2URaLpwHFfaLl1Vc5wj/OGD9ra2LNLiECKUZZHyu3EgWWwqstL9OKQIqm8p8AAwDvVQFqIjiKfAAAAABJRU5ErkJggg=="},EZj7:function(e,t){},FqrP:function(e,t){},GIYv:function(e,t){},HBSQ:function(e,t){},"HM/m":function(e,t){},K1zt:function(e,t){},NHnr:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s("MVMM"),r={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("router-view")],1)},staticRenderFns:[]};var i=s("Z0/y")({name:"App"},r,!1,function(e){s("GIYv")},null,null).exports,o=s("zO6J"),n={name:"headPortrait",props:["userId","isSave","imgUrl","indexPath","status","hasDetail","data"],data:function(){return{}},computed:{url:function(){return this.isSave?this.imgUrl?"http://"+this.$store.state.statisFileIp+this.imgUrl:null===this.userId?"":"http://"+this.$store.state.statisFileIp+"/headProtrait/"+this.userId+".jpg":this.imgUrl?"http://"+this.$store.state.statisFileIp+this.imgUrl+"?time="+(new Date).getTime():null===this.userId?"":"http://"+this.$store.state.statisFileIp+"/headProtrait/"+this.userId+".jpg?time="+(new Date).getTime()}},methods:{imgClick:function(){this.$emit("imgClick",this.indexPath)}},components:{}},d={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"headPortrait"},[e.hasDetail?a("div",[a("el-tooltip",{attrs:{placement:"top"}},[a("div",{attrs:{slot:"content"},slot:"content"},[a("p",[e._v("ID:"+e._s(e.userId))]),e._v(" "),a("p",[e._v("昵称:"+e._s(e.data.nickName))]),e._v(" "),a("p",[e._v("备注:"+e._s(e.data.remark))])]),e._v(" "),a("div",[a("div",{directives:[{name:"show",rawName:"v-show",value:0===e.status,expression:"status === 0"}],staticClass:"shelter",on:{click:function(t){return t.stopPropagation(),e.imgClick(t)}}}),e._v(" "),a("img",{staticClass:"headImg",attrs:{src:s("EVuS"),alt:""},on:{click:function(t){return t.stopPropagation(),e.imgClick(t)}}}),e._v(" "),a("img",{ref:"uerHead",class:{headImg:!0,userHeadImg:!0,yourHead:e.userId===this.$store.state.userId},attrs:{src:e.url,alt:""},on:{click:function(t){return t.stopPropagation(),e.imgClick(t)}}})])])],1):a("div",[a("div",{directives:[{name:"show",rawName:"v-show",value:0===e.status,expression:"status === 0"}],staticClass:"shelter",on:{click:function(t){return t.stopPropagation(),e.imgClick(t)}}}),e._v(" "),a("img",{staticClass:"headImg",attrs:{src:s("EVuS"),alt:""},on:{click:function(t){return t.stopPropagation(),e.imgClick(t)}}}),e._v(" "),a("img",{ref:"uerHead",class:{headImg:!0,userHeadImg:!0,yourHead:e.userId===this.$store.state.userId},attrs:{src:e.url,alt:""},on:{click:function(t){return t.stopPropagation(),e.imgClick(t)}}})])])},staticRenderFns:[]};var c=s("Z0/y")(n,d,!1,function(e){s("K1zt")},null,null).exports,l={name:"myHead",data:function(){return{activeIndex:"1",userOperateArr:[{label:"个人中心",value:1},{label:"退出账号",value:4}]}},computed:{socket:function(){return this.$store.state.socket},messagePush:function(){return this.$store.state.messagePush}},methods:{getNewTips:function(){var e=this;this.$http.post("/getNewTips.do",{userId:sessionStorage.getItem("userId")}).then(function(t){t.data.success&&(e.$store.state.remindTips=t.data.data.remindTips)})},mainOperate:function(e){1===e?this.$router.push({name:"personal"}):4===e&&(this.$store.dispatch("socketDisconnect"),this.$router.push({name:"login"}),sessionStorage.clear())},transformPath:function(e){switch(e){case"1":return"home";case"2":return"myMessage";case"3-1":return"myFriend";case"3-2":return"myGroups";default:return""}},handleSelect:function(e,t){this.$router.push({name:this.transformPath(e)})},getExpress:function(){var e=this;this.$http.post("/getExpress.do",{userId:sessionStorage.getItem("userId")}).then(function(t){t.data.success&&(e.$store.state.expressArr=t.data.data)})},getMessageToHead:function(e){var t=this;console.log("好友消息推送开启"),e.on("getMessageToHead",function(e){if(e.groupId){var s=void 0,a=(new Date).getTime();s=t.$notify({title:"群聊消息:"+e.groupName,dangerouslyUseHTMLString:!0,message:"<p>"+e.uName+':</p><div style="text-indent:2em;">'+(3===e.messageType?"[图像]":4===e.messageType?"[文件]":e.message)+'</div><button class="answerFriend '+e.from+"Button"+a+'">前去围观</button> ',duration:0}),document.getElementsByClassName(e.from+"Button"+a)[0].onclick=function(){s.close(),t.$router.push({name:"myGroups",params:{groupId:e.groupId}}),t.$store.state.myGroupCheckedId=e.groupId}}else{var r=void 0,i=(new Date).getTime();r=t.$notify({title:"好友消息",dangerouslyUseHTMLString:!0,message:"<p>"+(e.friendName||e.from)+':</p><div style="text-indent:2em;">'+(3===e.messageType?"[图像]":4===e.messageType?"[文件]":e.message)+'</div><button class="answerFriend '+e.from+"Button"+i+'">前往回复</button> ',duration:0}),document.getElementsByClassName(e.from+"Button"+i)[0].onclick=function(){r.close(),t.$router.push({name:"myFriend",params:{friendId:e.from}}),t.$store.state.myFriendCheckedId=e.from}}})}},mounted:function(){this.getExpress()},watch:{socket:{handler:function(e,t){var s=this;e&&null===t&&(e.on("getNewRemind",function(){s.getNewTips()}),this.getMessageToHead(e))},deep:!0},messagePush:function(e,t){this.$store.dispatch("friendRemand",-1!==e.indexOf("1")),console.log("好友消息推送关闭"),this.$store.state.socket.removeAllListeners("getMessageToHead"),e&&-1!==e.indexOf("2")&&this.getMessageToHead(this.$store.state.socket)}},components:{headPortrait:c}},u={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"my-head"},[a("img",{staticClass:"logo",attrs:{src:s("bIQm"),alt:""}}),e._v(" "),a("el-menu",{staticClass:"el-menu-demo",attrs:{"default-active":e.activeIndex,mode:"horizontal","background-color":"#545c64","text-color":"#fff","active-text-color":"#ffd04b"},on:{select:e.handleSelect}},[a("el-menu-item",{attrs:{index:"1"}},[e._v("主页")]),e._v(" "),a("el-menu-item",{attrs:{index:"2"}},[a("span",[e._v("我的消息")]),e._v(" "),0!==e.$store.state.remindTips?a("el-badge",{staticClass:"item",attrs:{value:e.$store.state.remindTips}},[a("span",[e._v("1")])]):e._e()],1),e._v(" "),a("el-submenu",{attrs:{index:"3"}},[a("template",{slot:"title"},[e._v("联系人")]),e._v(" "),a("el-menu-item",{attrs:{index:"3-1"}},[e._v("我的好友")]),e._v(" "),a("el-menu-item",{attrs:{index:"3-2"}},[e._v("我的群")])],2)],1),e._v(" "),a("div",{staticClass:"user"},[a("span",{staticClass:"username"},[e._v(e._s(e.$store.state.nickName||e.$store.state.userId))]),e._v(" "),a("el-dropdown",{on:{command:e.mainOperate}},[a("div",[a("headPortrait",{attrs:{userId:e.$store.state.userId}})],1),e._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},e._l(e.userOperateArr,function(t){return a("el-dropdown-item",{key:t.value,attrs:{command:t.value}},[e._v(e._s(t.label)+"\n        ")])}))],1)],1)],1)},staticRenderFns:[]};var p=s("Z0/y")(l,u,!1,function(e){s("Olqw")},null,null).exports,m=s("ZLEe"),g=s.n(m),h=s("UM93"),f=s.n(h),v=function(e,t){var s=new Date(e),a=s.getFullYear(),r=s.getMonth()+1;r<10&&(r="0"+r);var i=s.getDate();i<10&&(i="0"+i);var o=s.getHours();o<10&&(o="0"+o);var n=s.getMinutes();n<10&&(n="0"+n);var d=s.getSeconds();return d<10&&(d="0"+d),t.replace(/yyyy/,a).replace(/MM/,r).replace(/dd/,i).replace(/HH/,o).replace(/mm/,n).replace(/ss/,d)},I=function(e,t,s){if(void 0!=s){var a=new Date;a.setTime(a.getTime()+24*s*60*60*1e3);var r="expires="+a.toGMTString();document.cookie=e+"="+t+"; "+r}else document.cookie=e+"="+t+"; "},_=function(e){var t=[],s=e.match(/\{[0-9a-zA-Z]+(\-\g+){0,1}\}/gi);return s&&s.forEach(function(e){t.push(e.split("}")[0].split("{")[1])}),t},k=function(e,t,s,a){return 1===e?s.constructor===Array?s.forEach(function(e,s){var a=new RegExp("{"+e.name+"}","ig");t=t.replace(a,'<img src="data:image/png;base64,'+e.img+'" />')}):alert("imgArr不是数组"):2===e&&(console.log(s),s.constructor===Array?s.forEach(function(e,s){var r=new RegExp("{"+e.split(".")[0]+"}","ig");t=t.replace(r,'<img src="http://'+a+"/express/"+e+'" />')}):alert("imgArr不是数组")),t},y=function(e){e.scrollTop=e.scrollHeight-e.offsetHeight};var w={name:"home",data:function(){return{pc:null,other:null,videoStreamTrack:null,audioStreamTrack:null}},computed:{socket:function(){return this.$store.state.socket}},methods:{getNewTips:function(){var e=this;this.$http.post("/getNewTips.do",{userId:sessionStorage.getItem("userId")}).then(function(t){t.data.success&&(e.$store.state.remindTips=t.data.data.remindTips)})},closeVideo:function(){this.pc.close(),this.videoStreamTrack.stop(),this.audioStreamTrack.stop(),this.socket.emit("closeVideo",this.other),this.$store.state.isVideo=!1},videoCall:function(e,t){var s=this;window.URL=window.URL||window.webkitURL||window.mozURL||window.msURL,this.other=t;var a=window.RTCPeerConnection||window.webkitRTCPeerConnection||window.mozRTCPeerConnection||window.msRTCPeerConnection,r=window.RTCSessionDescription||window.mozRTCSessionDescription||window.webkitRTCSessionDescription;this.pc=new a({iceServers:[{url:"stun:stun.l.google.com:19302"},{url:"turn:numb.viagenie.ca",username:"webrtc@live.com",credential:"muazkh"}]}),this.pc.onicecandidate=function(e){null!==e.candidate&&(console.log("event.candidate:"+e.candidate+" to:",t),s.socket.emit("_ice_candidate",{candidate:e.candidate,to:t}))},this.pc.onaddstream=function(e){console.log("event.stream:"+e.stream),console.log("hisVideoSrc:"+window.URL.createObjectURL(e.stream)),"srcObject"in s.$refs.hisVideo?s.$refs.hisVideo.srcObject=e.stream:s.$refs.hisVideo.src=window.URL.createObjectURL(e.stream)};var i=function(e){s.pc.setLocalDescription(e),console.log("发送offer请求信令 desc:"+e),s.socket.emit("_offer",{sdp:e,to:t})},o=function(e){s.pc.setLocalDescription(e),console.log("回答信令 desc:"+e),s.socket.emit("_answer",{sdp:e,to:t})};navigator.mediaDevices&&navigator.mediaDevices.getUserMedia?navigator.mediaDevices.getUserMedia({audio:!0,video:!0}).then(function(t){s.audioStreamTrack=t.getTracks()[0],s.videoStreamTrack=t.getTracks()[1],"srcObject"in s.$refs.yourVideo?s.$refs.yourVideo.srcObject=t:s.$refs.yourVideo.src=window.URL.createObjectURL(t),console.log("yourVideoSrc:"+window.URL.createObjectURL(t)),s.pc.addStream(t),e&&s.pc.createOffer(i,function(e){console.log("Failure callback: "+e)})}).catch(function(e){console.log("getUserMedia error: "+e)}):(navigator.getUserMedia=navigator.getUserMedia||navigator.msGetUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia,navigator.getUserMedia({audio:!0,video:!0},function(t){s.audioStreamTrack=t.getTracks()[0],s.videoStreamTrack=t.getTracks()[1],"srcObject"in s.$refs.yourVideo?s.$refs.yourVideo.srcObject=t:s.$refs.yourVideo.src=window.URL.createObjectURL(t),console.log("yourVideoSrc:"+window.URL.createObjectURL(t)),s.pc.addStream(t),e&&s.pc.createOffer(i,function(e){console.log("Failure callback: "+e)})},function(e){console.log("getUserMedia error: "+e)})),this.socket.on("_ice_candidate",function(e){var t=e;console.log("增加_ice_candidate: ",t),s.pc.addIceCandidate(new RTCIceCandidate(t.candidate))}),this.socket.on("_offer",function(e){var t=e;s.pc.setRemoteDescription(new r(t.sdp)),s.pc.createAnswer(o,function(e){console.log("Failure callback: "+e)})}),this.socket.on("_answer",function(e){var t=e;s.pc.setRemoteDescription(new r(t.sdp))}),this.socket.on("closeVideo",function(e){s.$message({message:"对方关闭了视频聊天",type:"success"}),s.pc.close(),s.videoStreamTrack.stop(),s.audioStreamTrack.stop(),s.$store.state.isVideo=!1})}},watch:{socket:function(e,t){var s=this;e&&null===t&&(e.on("videoRequest",function(t){if(!document.getElementsByClassName(t.from.id+"Requset")[0]){var a=s.$notify({title:"提示",showClose:!1,dangerouslyUseHTMLString:!0,message:"<p>"+t.from.name+'向您发起视频请求</p><button class="operateVideoRequest '+t.from.id+'Requset">拒绝</button><button class="operateVideoRequest '+t.from.id+'Requset">同意</button>',duration:0}),r=document.getElementsByClassName(t.from.id+"Requset");console.log(s.$notify),r[0].onclick=function(){a.close(),s.$message({type:"danger",message:"已拒绝视频通话请求"})},r[1].onclick=function(){s.$store.state.isVideo?s.$message.error("只能同时与一个人进行视频通话"):(a.close(),s.$store.state.isVideo=!0,e.emit("agreeVideoRequest",t),s.videoCall(!1,t.from))}}}),e.on("agreeVideoRequest",function(e){s.$store.state.isVideo=!0,s.videoCall(!0,e.to)}),e.on("duplicateLogin",function(){s.$store.dispatch("socketDisconnect"),sessionStorage.removeItem("userId"),s.$alert("您的账号在其他地址登录！该账号即将下线。","提示",{confirmButtonText:"确定",callback:function(e){s.$router.push({name:"login"}),sessionStorage.clear()}})}))}},mounted:function(){var e=this;this.getNewTips(),document.oncontextmenu=function(e){e.preventDefault()},this.$store.state.userId?this.$store.dispatch("connectSocket"):null!==sessionStorage.getItem("userId")&&null!==sessionStorage.getItem("password")?this.$http.post("/login.do",{userId:sessionStorage.getItem("userId"),password:sessionStorage.getItem("password")}).then(function(t){t.data.success&&(e.$store.state.userId=sessionStorage.getItem("userId"),e.$store.state.nickName=t.data.data.U_NickName||"",I("userId",sessionStorage.getItem("userId")),sessionStorage.setItem("messagePush",t.data.data.U_MessagePush),e.$store.state.messagePush=t.data.data.U_MessagePush,e.$store.dispatch("connectSocket"))}):(this.$message.error("请重新登录"),this.$router.push({name:"login"}))},components:{myHead:p}},$={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"home"},[a("img",{staticClass:"main-bg",attrs:{src:s("28BC"),alt:""}}),e._v(" "),e.$store.state.isVideo?a("div",{staticClass:"video-group"},[a("video",{ref:"yourVideo",staticClass:"video video1",attrs:{src:"",autoplay:""}}),e._v(" "),a("video",{ref:"hisVideo",staticClass:"video video2",attrs:{src:"",autoplay:""}}),e._v(" "),a("i",{staticClass:"el-icon-close",on:{click:e.closeVideo}})]):e._e(),e._v(" "),a("myHead"),e._v(" "),a("div",{staticClass:"content"},[a("keep-alive",[a("router-view")],1)],1)],1)},staticRenderFns:[]};var D=s("Z0/y")(w,$,!1,function(e){s("si95")},null,null).exports,b={name:"login",data:function(){return{isForgetLoading:!1,forgetEmail:"",forgetId:"",wrapType:1,isLoading:!1,userId:"",password:"",registerParams:{userId:"",fPassword:"",sPassword:"",email:""},tip:{userId:0,fPassword:0,sPassword:0,email:0}}},mounted:function(){sessionStorage.clear(),this.$store.state.userId=null,this.$store.state.nickName=null,this.$store.state.socket=null,"true"==localStorage.isRemember&&(this.$refs.remember.checked=!0,this.userId=localStorage.userId,this.password=localStorage.password)},methods:{getPassword:function(){var e=this;""!=this.forgetId&&""!=this.forgetEmail?(this.isForgetLoading=!0,this.$http.post("/getPassword.do",{forgetId:this.forgetId,email:this.forgetEmail}).then(function(t){t.data.success&&e.$message({message:"邮件发送成功,请查收",type:"success"}),e.isForgetLoading=!1})):this.$message.error("账号和邮箱不能为空")},checkEmail:function(){""!==this.registerParams.email?new RegExp(/^[A-Za-z0-9\u4e00-\u9fa5]+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$/i).test(this.registerParams.email)?this.tip.email=0:this.tip.email=1:this.tip.email=2},checkSPassword:function(){""!==this.registerParams.sPassword?this.registerParams.fPassword===this.registerParams.sPassword||""===this.registerParams.fPassword?(this.tip.sPassword=0,this.tip.fPassword=0):this.tip.sPassword=1:this.tip.sPassword=2},checkFPassword:function(){""!==this.registerParams.fPassword?this.registerParams.fPassword===this.registerParams.sPassword||""===this.registerParams.sPassword?(this.tip.fPassword=0,this.tip.sPassword=0):this.tip.fPassword=1:this.tip.fPassword=2},checkuserId:function(){var e=this;""!=this.registerParams.userId?this.$http.get("/checkuserId.do",{params:{userId:this.registerParams.userId}}).then(function(t){t.data.success&&(0==t.data.data.length?e.tip.userId=3:e.tip.userId=1)}):this.tip.userId=2},register:function(){var e=this;g()(this.registerParams).forEach(function(t){""==e.registerParams[t]&&(e.tip[t]=2)}),3==this.tip.userId&&0==this.tip.email&&0==this.tip.fPassword&&0==this.tip.sPassword&&this.$http.get("/sendRegEmail.do",{params:{userId:this.registerParams.userId,password:this.registerParams.fPassword,email:this.registerParams.email}}).then(function(t){t.data.success&&e.$message({message:"邮件发送成功,请去邮箱激活该账号",type:"success"})})},clickRemember:function(){localStorage.isRemember=this.$refs.remember.checked,"true"!=localStorage.isRemember?(localStorage.userId="",localStorage.password=""):(localStorage.userId=this.userId,localStorage.password=this.password)},login:function(){var e=this;"true"===localStorage.isRemember&&(localStorage.userId=this.userId,localStorage.password=this.password),""!=this.userId&&""!=this.password?(this.isLoading=!0,this.$http.post("/login.do",{userId:this.userId,password:this.password}).then(function(t){e.isLoading=!1,t.data.success&&(sessionStorage.setItem("userId",e.userId),sessionStorage.setItem("password",e.password),sessionStorage.setItem("messagePush",t.data.data.U_MessagePush),e.$store.state.messagePush=t.data.data.U_MessagePush,e.$store.state.userId=e.userId,e.$store.state.nickName=t.data.data.U_NickName,I("userId",e.userId),e.$router.push({name:"home"}))})):this.$message.error("账号和密码不能为空")}},watch:{wrapType:function(e){2===e?(this.tip={userId:0,fPassword:0,sPassword:0,email:0},this.registerParams={userId:"",fPassword:"",sPassword:"",email:""}):3===e&&(this.forgetEmail=this.forgetId="")}}},F={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"login"},[s("div",{staticClass:"warp",class:{registerWarp:2===e.wrapType,forgetWrap:3===e.wrapType}},[s("div",{directives:[{name:"show",rawName:"v-show",value:1===e.wrapType,expression:"wrapType===1"}]},[s("div",{staticClass:"input-group"},[s("label",{attrs:{for:"userId"}},[e._v("账号:")]),e._v(" "),s("el-input",{attrs:{maxlength:20,id:"userId"},model:{value:e.userId,callback:function(t){e.userId=t},expression:"userId"}})],1),e._v(" "),s("div",{staticClass:"input-group"},[s("label",{attrs:{for:"password"}},[e._v("密码:")]),e._v(" "),s("el-input",{attrs:{maxlength:20,id:"password",type:"password"},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}})],1),e._v(" "),s("div",{staticClass:"input-group clearfix"},[s("input",{ref:"remember",staticClass:"fl",attrs:{id:"remember",type:"checkbox"},on:{click:e.clickRemember}}),e._v(" "),s("label",{staticClass:"fl",attrs:{for:"remember"}},[e._v("记住密码")]),e._v(" "),s("a",{staticClass:"forget fr",attrs:{href:"javascript:;"},on:{click:function(t){e.wrapType=3}}},[e._v("忘记密码")])]),e._v(" "),s("div",{staticClass:"input-group"},[s("el-button",{attrs:{disabled:e.isLoading,loading:e.isLoading,type:"primary"},on:{click:e.login}},[e._v("登录")])],1),e._v(" "),s("div",{staticClass:"input-group"},[s("el-button",{attrs:{type:"primary"},on:{click:function(t){e.wrapType=2}}},[e._v("注册")])],1)]),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:2===e.wrapType,expression:"wrapType===2"}],staticClass:"register-warp"},[s("label",{attrs:{for:"ruserId"}},[e._v("账号:")]),e._v(" "),s("el-input",{attrs:{maxlength:20,id:"ruserId"},on:{blur:e.checkuserId},model:{value:e.registerParams.userId,callback:function(t){e.$set(e.registerParams,"userId",t)},expression:"registerParams.userId"}}),e._v(" "),s("div",{staticClass:"alerts"},[1==e.tip.userId?s("el-alert",{attrs:{title:"该用户已注册",type:"error",closable:!1}}):e._e(),e._v(" "),3==e.tip.userId?s("el-alert",{attrs:{title:"可以注册",type:"success",closable:!1}}):e._e(),e._v(" "),2==e.tip.userId?s("el-alert",{attrs:{title:"用户名不能为空",type:"error",closable:!1}}):e._e()],1),e._v(" "),s("label",{attrs:{for:"rFPassword"}},[e._v("密码:")]),e._v(" "),s("el-input",{attrs:{maxlength:20,id:"rFPassword",type:"password"},on:{blur:e.checkFPassword},model:{value:e.registerParams.fPassword,callback:function(t){e.$set(e.registerParams,"fPassword",t)},expression:"registerParams.fPassword"}}),e._v(" "),s("div",{staticClass:"alerts"},[1==e.tip.fPassword?s("el-alert",{attrs:{title:"密码不一致",type:"error",closable:!1}}):e._e(),e._v(" "),2==e.tip.fPassword?s("el-alert",{attrs:{title:"密码不能为空",type:"error",closable:!1}}):e._e()],1),e._v(" "),s("label",{attrs:{for:"rSPassword"}},[e._v("确认密码:")]),e._v(" "),s("el-input",{attrs:{maxlength:20,id:"rSPassword",type:"password"},on:{blur:e.checkSPassword},model:{value:e.registerParams.sPassword,callback:function(t){e.$set(e.registerParams,"sPassword",t)},expression:"registerParams.sPassword"}}),e._v(" "),s("div",{staticClass:"alerts"},[1==e.tip.sPassword?s("el-alert",{attrs:{title:"密码不一致",type:"error",closable:!1}}):e._e(),e._v(" "),2==e.tip.sPassword?s("el-alert",{attrs:{title:"密码不能为空",type:"error",closable:!1}}):e._e()],1),e._v(" "),s("label",{attrs:{for:"email"}},[e._v("邮箱:")]),e._v(" "),s("el-input",{attrs:{id:"email",type:"text"},on:{blur:e.checkEmail},model:{value:e.registerParams.email,callback:function(t){e.$set(e.registerParams,"email",t)},expression:"registerParams.email"}}),e._v(" "),s("div",{staticClass:"alerts"},[1==e.tip.email?s("el-alert",{attrs:{title:"邮箱格式不正确",type:"error",closable:!1}}):e._e(),e._v(" "),2==e.tip.email?s("el-alert",{attrs:{title:"邮箱不能为空",type:"error",closable:!1}}):e._e()],1),e._v(" "),s("div",{staticClass:"button-group"},[s("el-button",{attrs:{type:"primary"},on:{click:e.register}},[e._v("注册")]),e._v(" "),s("el-button",{attrs:{type:"primary",plain:""},on:{click:function(t){e.wrapType=1}}},[e._v("返回")])],1)],1),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:3===e.wrapType,expression:"wrapType===3"}],staticClass:"forget-warp"},[s("label",[e._v("账号:")]),e._v(" "),s("el-input",{attrs:{maxlength:20,placeholder:"请输入账号"},on:{blur:function(e){}},model:{value:e.forgetId,callback:function(t){e.forgetId=t},expression:"forgetId"}}),e._v(" "),s("label",[e._v("邮箱:")]),e._v(" "),s("el-input",{attrs:{placeholder:"请输入邮箱"},on:{blur:function(e){}},model:{value:e.forgetEmail,callback:function(t){e.forgetEmail=t},expression:"forgetEmail"}}),e._v(" "),s("div",{staticClass:"button-group"},[s("el-button",{attrs:{type:"primary",disabled:e.isForgetLoading,loading:e.isForgetLoading},on:{click:e.getPassword}},[e._v("确定")]),e._v(" "),s("el-button",{attrs:{type:"primary",plain:""},on:{click:function(t){e.wrapType=1}}},[e._v("返回")])],1)],1)])])},staticRenderFns:[]};var N=s("Z0/y")(b,F,!1,function(e){s("BNMO")},null,null).exports,P={name:"register",data:function(){return{}},mounted:function(){var e=this;console.log(this.$route),console.log(this.$router),this.$http.get("/emailReg.do",{params:{uid:this.$route.query.uid}}).then(function(t){t.data.success&&e.$message({message:"注册成功",type:"success"}),e.$router.push({name:"login"})})}},x={render:function(){var e=this.$createElement;return(this._self._c||e)("div",{staticClass:"register"})},staticRenderFns:[]};var G=s("Z0/y")(P,x,!1,function(e){s("c/3I")},null,null).exports,C=s("rVsN"),T=s.n(C),U=s("lC5x"),L=s.n(U),M=s("J0Oq"),R=s.n(M),A={name:"aMessage",props:["name","isAtRight","expressArr","data"],data:function(){return{message:""}},computed:{file:function(){var e={name:"",path:"",iconPath:""};if(4===this.data.messageType){var t=this.data.filePath.split("/");e.name=t[t.length-1],e.path="http://"+this.$store.state.statisFileIp+this.data.filePath,e.iconPath="http://"+this.$store.state.statisFileIp+"/file/baseIcon/file1.jpg"}return e}},mounted:function(){},methods:{download:function(){var e=this;this.$message({type:"success",message:"正在下载"}),this.$http.get("/downloadFile.do",{params:{filePath:this.data.filePath}}).then(function(t){window.open(t,"_blank"),e.$message({type:"success",message:"下载完成"})})},imgClick:function(e){this.$emit("imgClick",e)}},components:{headPortrait:c}},S={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{class:{aMessage:!0,atRight:e.isAtRight}},[s("headPortrait",{class:{fl:!e.isAtRight,fr:e.isAtRight},attrs:{indexPath:e.data.senderId,isSave:!1,userId:e.data.senderId},on:{imgClick:e.imgClick}}),e._v(" "),s("div",{staticClass:"content",class:{fl:!e.isAtRight,fr:e.isAtRight}},[s("span",{attrs:{id:"name"}},[e._v(e._s(e.name))]),e._v(" "),4!==e.data.messageType?s("div",{domProps:{innerHTML:e._s(e.data.message)}}):e._e(),e._v(" "),4===e.data.messageType?s("div",{staticClass:"file-wrap"},[s("img",{attrs:{src:e.file.iconPath,alt:""}}),e._v(" "),s("div",[s("p",[e._v(e._s(e.file.name))]),e._v(" "),s("a",{attrs:{href:"/downloadFile.do?filePath="+e.data.filePath}},[e._v("下载")])])]):e._e()])],1)},staticRenderFns:[]};var E=s("Z0/y")(A,S,!1,function(e){s("DCDw")},null,null).exports,B=s("3cXf"),j=s.n(B),O={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-dialog",{attrs:{title:e.openTitle,"before-close":e.confirmClose,visible:e.dialogFlag,"close-on-click-modal":!1},on:{close:e.close,"update:visible":function(t){e.dialogFlag=t},open:e.open}},[e._t("dialogContent"),e._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e.tip?s("div",{staticClass:"tip"},[e._v(e._s(e.tip))]):e._e(),e._v(" "),e._t("footerButton"),e._v(" "),!1!==e.isDefaultBtn?s("div",[s("el-button",{attrs:{disabled:e.isSaveLoading,loading:e.isSaveLoading,type:"primary"},on:{click:e.save}},[e._v("保存")]),e._v(" "),s("el-button",{on:{click:e.close}},[e._v("取 消")])],1):e._e()],2)],2)},staticRenderFns:[]};var Z=s("Z0/y")({name:"dialogs",props:["dialogFlag","openTitle","tip","openData","isDefaultBtn","isBeforeClose","isSaveLoading"],methods:{confirmClose:function(e){!0!==this.isBeforeClose?e():this.$emit("confirmClose")},save:function(){this.$emit("save")},close:function(){this.$emit("update:dialogFlag",!1),this.$emit("close")},open:function(){this.$emit("open")}}},O,!1,function(e){s("0byE")},null,null).exports,V={name:"friendDetailDialog",props:["dialogFlag","openData"],data:function(){return{timeFormat:v}},methods:{open:function(){},close:function(){this.$emit("update:dialogFlag",!1)}},components:{dialogs:Z,headPortrait:c}},z={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"friendDetailDialog"},[s("dialogs",{attrs:{dialogFlag:e.dialogFlag,openTitle:"ID:"+e.openData.userId,isDefaultBtn:!1},on:{"update:dialogFlag":function(t){e.dialogFlag=t},close:e.close,open:e.open}},[s("div",{attrs:{slot:"dialogContent"},slot:"dialogContent"},[s("div",{staticClass:"headImg"},[s("headPortrait",{attrs:{isSave:!1,userId:e.openData.userId}})],1),e._v(" "),s("el-row",[s("el-col",{attrs:{span:12}},[e._v("昵称：")]),e._v(" "),s("el-col",{attrs:{span:12}},[e._v(e._s(e.openData.nickName||"暂无"))])],1),e._v(" "),s("el-row",[s("el-col",{attrs:{span:12}},[e._v("年龄：")]),e._v(" "),s("el-col",{attrs:{span:12}},[e._v(e._s(e.openData.age||"暂无"))])],1),e._v(" "),s("el-row",[s("el-col",{attrs:{span:12}},[e._v("电话：")]),e._v(" "),s("el-col",{attrs:{span:12}},[e._v(e._s(e.openData.phone||"暂无"))])],1),e._v(" "),s("el-row",[s("el-col",{attrs:{span:12}},[e._v("生日：")]),e._v(" "),s("el-col",{attrs:{span:12}},[e._v(e._s(e.openData.birthday?e.timeFormat(parseInt(e.openData.birthday),"yyyy-MM-dd"):"暂无"))])],1),e._v(" "),s("el-row",[s("el-col",{attrs:{span:12}},[e._v("邮箱：")]),e._v(" "),s("el-col",{attrs:{span:12}},[e._v(e._s(e.openData.email||"暂无"))])],1),e._v(" "),s("el-row",[s("el-col",{attrs:{span:12}},[e._v("真实姓名：")]),e._v(" "),s("el-col",{attrs:{span:12}},[e._v(e._s(e.openData.name||"暂无"))])],1),e._v(" "),s("el-row",[s("el-col",{attrs:{span:12}},[e._v("性别：")]),e._v(" "),s("el-col",{attrs:{span:12}},[e._v(e._s("1"===e.openData.sex?"男":"0"===e.openData.sex?"女":"暂无"))])],1)],1)])],1)},staticRenderFns:[]};var H=s("Z0/y")(V,z,!1,function(e){s("23xk")},null,null).exports,W={name:"chatWindow",props:["chatType","chatId"],data:function(){return{detailData:"",friendDetailFlag:!1,isMessageLoading:!1,pageNo:1,total:0,message:"",messageRecord:[],openTime:"",isLoadingImage:!1,friendDetailData:{},expressArr:JSON.parse(j()(this.$store.state.expressArr)),isShow:!0,isDestroyed:!1}},computed:{socket:function(){return this.$store.state.socket},picAction:function(){var e=this;return 1===this.chatType?"/uploadPicture.do?userId="+this.$store.state.userId+"&&friendId="+this.chatId:this.detailData&&this.detailData.members.some(function(t){return t.memberId===e.$store.state.userId})?"/uploadGroupPicture.do?userId="+this.$store.state.userId+"&&groupId="+this.chatId+"&&uName="+(this.detailData.members.filter(function(t){return t.memberId===e.$store.state.userId})[0].groupNick||this.$store.state.nickName||this.$store.state.userId):""},fileAction:function(){var e=this;return 1===this.chatType?"/uploadFile.do?userId="+this.$store.state.userId+"&&friendId="+this.chatId:this.detailData&&this.detailData.members.some(function(t){return t.memberId===e.$store.state.userId})?"/uploadGroupFile.do?userId="+this.$store.state.userId+"&&groupId="+this.chatId+"&&uName="+(this.detailData.members.filter(function(t){return t.memberId===e.$store.state.userId})[0].groupNick||this.$store.state.nickName||this.$store.state.userId):""}},mounted:function(){this.init()},destroyed:function(){this.isDestroyed=!0},methods:{getNewTips:function(){var e=this;this.$http.post("/getNewTips.do",{userId:sessionStorage.getItem("userId")}).then(function(t){t.data.success&&(e.$store.state.remindTips=t.data.data.remindTips)})},getGroupDetailData:function(e){return this.$http.post("/getGroupDetailData.do",{groupId:e})},getGroupMembers:function(e){return this.$http.post("/getGroupMembers.do",{groupId:e})},getDetailData:function(){var e=this;return new T.a(function(t){1===e.chatType?e.$http.post("/getFriendInfo.do",{userId:e.$store.state.userId,friendId:e.chatId}).then(function(s){s.data.success&&(s.data.data.forEach(function(t){e.detailData={remark:t.F_Name,nickName:t.U_NickName,friendId:t.F_FriendID,status:t.U_UserStateID,friendGroupsId:t.F_FriendGroupsID}}),t())}):T.a.all([e.getGroupDetailData(e.chatId),e.getGroupMembers(e.chatId)]).then(function(s){if(s[0].data.success&&s[1].data.success){if(0===s[0].data.data.length)return void e.$message.error("该群不存在");e.detailData={groupId:s[0].data.data[0].UG_ID,groupName:s[0].data.data[0].UG_Name,groupIntro:s[0].data.data[0].UG_Intro,groupNotice:s[0].data.data[0].UG_Notice,icon:s[0].data.data[0].UG_Icon,createTime:s[0].data.data[0].UG_CreateTime,adminId:s[0].data.data[0].UG_AdminID,members:[]},s[1].data.data.forEach(function(t){e.detailData.members.push({groupNick:t.UGU_GroupNick,memberId:t.UGU_UserID,joinTime:t.UGU_CreateTime,authority:t.UGU_Authority})}),t()}})})},imgClick:function(e){var t=this;this.$http.post("/getUserInfo.do",{userId:e}).then(function(e){e.data.success&&(t.friendDetailData={userId:e.data.data[0].U_LoginID,nickName:e.data.data[0].U_NickName,age:e.data.data[0].U_Age,birthday:e.data.data[0].U_Birthday,phone:e.data.data[0].U_Telephone,email:e.data.data[0].U_Email,name:e.data.data[0].U_Name,sex:e.data.data[0].U_Sex},t.friendDetailFlag=!0)})},beforeFileUpload:function(e){var t=e.size/1024/1024<100;return!t&&this.$message.error("文件不能超过100Mb"),t},fileUpdateSuccess:function(e,t){var s=this;this.messageRecord.push({senderId:this.$store.state.userId,name:this.$store.state.nickName||this.$store.state.userId,filePath:e.data.filePath,isAtRight:!0,messageType:4}),1===this.chatType?this.socket.emit("remandFriend",{from:e.data.from,friendName:this.detailData.remark||this.detailData.nickName||this.detailData.friendId,filePath:e.data.filePath,to:e.data.to,messageType:4}):this.socket.emit("remandFriend",{from:e.data.from,filePath:e.data.filePath,groupId:this.chatId,groupName:this.detailData.groupName,uName:e.data.uName,messageType:4}),this.$refs.uploadFile.clearFiles(),this.$nextTick(function(){y(s.$refs.message.$el)})},beforePicUpload:function(e){var t=e.name.split("."),s=t[t.length-1].toLowerCase(),a=e.size/1024/1024<10,r=/mov|avi|flv|mp4|rmvb|mkv|jpeg|bmp|jpg|png|gif/i.test(s);return!a&&this.$message.error("文件不能超过10Mb"),!r&&this.$message.error("不识别此格式文件"),r&&a},picUpdateSuccess:function(e,t){var s=this,a=t.name.split("."),r=a[a.length-1].toLowerCase();1===this.chatType?/mov|avi|flv|mp4|rmvb|mkv/i.test(r)?(this.messageRecord.push({senderId:this.$store.state.userId,name:this.$store.state.nickName||this.$store.state.userId,message:'<video src="'+t.url+'" loop controls></video>',isAtRight:!0,messageType:3}),this.socket.emit("remandFriend",{message:'<video src="http://'+(this.$store.state.statisFileIp+e.data.filePath)+'" loop controls></video>',from:e.data.from,friendName:this.detailData.remark||this.detailData.nickName||this.detailData.friendId,to:e.data.to,messageType:3})):/jpeg|bmp|jpg|png|gif/i.test(r)&&(this.messageRecord.push({senderId:this.$store.state.userId,name:this.$store.state.nickName||this.$store.state.userId,message:"<img src='"+t.url+"'></img>",isAtRight:!0,messageType:3}),this.socket.emit("remandFriend",{message:'<img src="http://'+(this.$store.state.statisFileIp+e.data.filePath)+'"></img>',from:e.data.from,friendName:this.detailData.remark||this.detailData.nickName||this.detailData.friendId,to:e.data.to,messageType:3})):/mov|avi|flv|mp4|rmvb|mkv/i.test(r)?(this.messageRecord.push({senderId:this.$store.state.userId,name:e.data.uName,message:'<video src="'+t.url+'" loop controls></video>',isAtRight:!0,messageType:3}),this.socket.emit("remandFriend",{message:'<video src="http://'+(this.$store.state.statisFileIp+e.data.filePath)+'" loop controls></video>',from:e.data.from,groupId:this.chatId,groupName:this.detailData.groupName,uName:e.data.uName,messageType:3})):/jpeg|bmp|jpg|png|gif/i.test(r)&&(this.messageRecord.push({senderId:this.$store.state.userId,name:this.$store.state.nickName||this.$store.state.userId,message:"<img src='"+t.url+"'></img>",isAtRight:!0,messageType:3}),this.socket.emit("remandFriend",{message:'<img src="http://'+(this.$store.state.statisFileIp+e.data.filePath)+'"></img>',from:e.data.from,groupId:this.chatId,groupName:this.detailData.groupName,uName:e.data.uName,messageType:3})),this.$refs.uploadPic.clearFiles(),this.$nextTick(function(){y(s.$refs.message.$el)})},videoRequest:function(){this.$store.state.socket.emit("videoRequest",{to:{id:this.chatId,name:this.detailData.remark||this.detailData.nickName||this.detailData.friendId},from:{id:this.$store.state.userId,name:this.$store.state.nickName||this.$store.state.userId}}),this.$message({message:"已发送视频通话请求",type:"success"})},clickExpress:function(e){this.message+="{"+this.expressArr[e].split(".")[0]+"}"},getExpress:function(){var e=this;0===this.expressArr.length&&(this.isLoadingImage=!0,this.$http.post("/getExpress.do",{userId:this.$store.state.userId}).then(function(t){t.data.success&&(e.expressArr=e.$store.state.expressArr=t.data.data,e.isLoadingImage=!1)}))},sendMessage:function(){var e=this;if(""!==this.message){var t=void 0,s=void 0;1===this.chatType?t={messageType:1,message:this.message,from:sessionStorage.getItem("userId"),to:this.chatId,userName:this.$store.state.nickName}:(s=this.detailData.members.filter(function(t){return t.memberId===e.$store.state.userId})[0].groupNick,t={messageType:1,message:this.message,from:this.$store.state.userId,fromName:this.detailData.groupName,groupId:this.chatId,uName:s||this.$store.state.nickName||this.$store.state.userId});var a=this.message.match(/\{[0-9a-zA-Z]+(\-\g+){0,1}\}/gi);a&&a.forEach(function(s,a){var r=s.split("}")[0].split("{")[1];e.expressArr.some(function(e){return e.split(".")[0]==r})&&(t.messageType=2,t.expressName?t.expressName+=","+r:(t.expressName="",t.expressName+=r))});var r=void 0;r=1===this.chatType?"/sendMessage.do":"/sendGroupMessage.do",this.$http.post(r,t).then(function(a){a.data.success&&(e.$message({message:"发送成功",type:"success"}),1===e.chatType?(e.messageRecord.push({senderId:e.$store.state.userId,name:e.$store.state.nickName||e.$store.state.userId,message:k(2,e.message,e.expressArr.filter(function(t){return _(e.message).includes(t.split(".")[0])}),e.$store.state.statisFileIp),isAtRight:!0}),e.$store.state.socket.emit("remandFriend",{message:k(2,e.message,e.expressArr.filter(function(t){return _(e.message).includes(t.split(".")[0])}),e.$store.state.statisFileIp),from:sessionStorage.getItem("userId"),to:e.chatId,friendName:e.detailData.remark||e.detailData.nickName||e.detailData.friendId,messageType:t.messageType})):(e.messageRecord.push({senderId:e.$store.state.userId,name:s||e.$store.state.nickName||e.$store.state.userId,message:k(2,e.message,e.expressArr.filter(function(t){return _(e.message).includes(t.split(".")[0])}),e.$store.state.statisFileIp),isAtRight:!0}),e.$store.state.socket.emit("remandFriend",{message:k(2,e.message,e.expressArr.filter(function(t){return _(e.message).includes(t.split(".")[0])}),e.$store.state.statisFileIp),from:e.$store.state.userId,groupId:e.chatId,groupName:e.detailData.groupName,uName:t.uName})),e.$nextTick(function(){y(e.$refs.message.$el)}),e.message="")})}},init:function(){var e=this;this.isDestroyed=!1,this.messageRecord=[],this.detailData="",this.pageNo=1,this.total=0,this.isShow=!0,this.openTime=(new Date).getTime(),this.getDetailData().then(function(){1===e.chatType?e.getFriendMessage().then(function(){e.$nextTick(function(){e.isShow&&(e.toTopEvent(),y(e.$refs.message.$el))})}):e.getGroupMessage().then(function(){e.$nextTick(function(){e.isShow&&(e.toTopEvent(),y(e.$refs.message.$el))})}),e.listenMessage()})},getFriendMessage:function(){var e=this;return new T.a(function(t){e.isMessageLoading=!0,e.$http.post("/getFriendMessage.do",{openTime:e.openTime,pageNo:e.pageNo,pageSize:e.$store.state.pageSize,userId:sessionStorage.getItem("userId"),friendId:e.chatId}).then(function(s){s.data.success&&(e.total=s.data.total,e.getNewTips(),0!==s.data.data.length&&s.data.data.forEach(function(s){var a=void 0,r=s.M_PostMessages;if(s.M_FromUserID===e.chatId&&(a=e.detailData.remark||e.detailData.nickName||e.detailData.friendId),[3,4].includes(s.M_MessageTypeID)){var i=s.M_FilePath.split("."),o=i[i.length-1].toLowerCase();/mov|avi|flv|mp4|rmvb|mkv/i.test(o)?e.messageRecord.unshift({message:'<video src="http://'+(e.$store.state.statisFileIp+s.M_FilePath)+'" loop controls></video>',senderId:s.M_FromUserID,name:s.M_FromUserID!==e.chatId?e.$store.state.nickName||e.$store.state.userId:a,isAtRight:s.M_FromUserID!==e.chatId,messageType:s.M_MessageTypeID,filePath:s.M_FilePath}):/jpeg|bmp|jpg|png|gif/i.test(o)?e.messageRecord.unshift({message:"<img src='http://"+(e.$store.state.statisFileIp+s.M_FilePath)+"'></img>",senderId:s.M_FromUserID,name:s.M_FromUserID!==e.chatId?e.$store.state.nickName||e.$store.state.userId:a,isAtRight:s.M_FromUserID!==e.chatId,messageType:s.M_MessageTypeID,filePath:s.M_FilePath}):e.messageRecord.unshift({message:s.M_PostMessages,senderId:s.M_FromUserID,name:s.M_FromUserID!==e.chatId?e.$store.state.nickName||e.$store.state.userId:a,isAtRight:s.M_FromUserID!==e.chatId,messageType:s.M_MessageTypeID,filePath:s.M_FilePath})}else[1,2].includes(s.M_MessageTypeID)&&(s.expressArr&&(r=k(1,r,s.expressArr)),e.messageRecord.unshift({senderId:s.M_FromUserID,name:s.M_FromUserID!==e.chatId?e.$store.state.nickName||e.$store.state.userId:a,message:r,isAtRight:s.M_FromUserID!==e.chatId,messageType:s.M_MessageTypeID,filePath:s.M_FilePath}));t()})),1===s.data.code&&(e.messageRecord={},e.isShow=!1),e.isMessageLoading=!1}).catch(function(){e.isMessageLoading=!1})})},getGroupMessage:function(){var e=this;return new T.a(function(t){e.isMessageLoading=!0,e.$http.post("/getGroupMessage.do",{openTime:e.openTime,pageNo:e.pageNo,pageSize:e.$store.state.pageSize,groupId:e.chatId,userId:e.$store.state.userId}).then(function(s){s.data.success&&(e.total=s.data.total,e.getNewTips(),0!==s.data.data.length&&s.data.data.forEach(function(t){var s=t.GM_Message;if([3,4].includes(t.GM_MessageType)){var a=t.GM_FilePath.split("."),r=a[a.length-1].toLowerCase();/mov|avi|flv|mp4|rmvb|mkv/i.test(r)?e.messageRecord.unshift({message:'<video src="http://'+(e.$store.state.statisFileIp+t.GM_FilePath)+'" loop controls></video>',senderId:t.GM_FromID,name:t.GM_FromUName,isAtRight:t.GM_FromID===e.$store.state.userId,messageType:t.GM_MessageType,filePath:t.GM_FilePath}):/jpeg|bmp|jpg|png|gif/i.test(r)?e.messageRecord.unshift({message:"<img src='http://"+(e.$store.state.statisFileIp+t.GM_FilePath)+"'></img>",senderId:t.GM_FromID,name:t.GM_FromUName,isAtRight:t.GM_FromID===e.$store.state.userId,messageType:t.GM_MessageType,filePath:t.GM_FilePath}):e.messageRecord.unshift({message:t.GM_Message,senderId:t.GM_FromID,name:t.GM_FromUName,isAtRight:t.GM_FromID===e.$store.state.userId,messageType:t.GM_MessageType,filePath:t.GM_FilePath})}else[1,2].includes(t.GM_MessageType)&&(t.expressArr&&(s=k(1,s,t.expressArr)),e.messageRecord.unshift({message:s,senderId:t.GM_FromID,name:t.GM_FromUName,isAtRight:t.GM_FromID===e.$store.state.userId,messageType:t.GM_MessageType,filePath:t.GM_FilePath}))}),t()),1===s.data.code&&(e.messageRecord={},e.isShow=!1),e.isMessageLoading=!1}).catch(function(){e.isMessageLoading=!1})})},toTopEvent:function(){var e,t,s=this;e=this.$refs.message.$el,t=function(){if(!(Math.ceil(s.total/s.$store.state.pageSize)<s.pageNo+1||s.isMessageLoading)){s.pageNo++;var e=s.$refs.message.$el.scrollHeight;1===s.chatType?s.getFriendMessage().then(function(){s.$nextTick(function(){s.$refs.message.$el.scrollTop=s.$refs.message.$el.scrollHeight-e})}):s.getGroupMessage().then(function(){s.$nextTick(function(){s.$refs.message.$el.scrollTop=s.$refs.message.$el.scrollHeight-e})})}},e.onscroll=function(){0===e.scrollTop&&t()}},listenMessage:function(){var e=this;this.$store.state.socket.on("getMessage",function(t){if(!e.isDestroyed)if(void 0!==t.groupId)t.groupId===e.chatId&&(e.$http.post("/updateRemind.do",{fromId:e.chatId,userId:e.$store.state.userId,type:e.chatType}).then(function(t){t.data.success&&e.getNewTips()}),e.messageRecord.push({senderId:t.from,name:t.uName,message:t.message,isAtRight:!1,filePath:t.filePath,messageType:t.messageType}),e.$nextTick(function(){y(e.$refs.message.$el)}));else if(t.from===e.chatId){e.$http.post("/updateRemind.do",{fromId:e.chatId,userId:e.$store.state.userId,type:e.chatType}).then(function(t){t.data.success&&e.getNewTips()});var s=e.detailData.remark||e.detailData.nickName||e.detailData.friendId;e.messageRecord.push({senderId:t.from,name:s,message:t.message,isAtRight:!1,filePath:t.filePath,messageType:t.messageType}),e.$nextTick(function(){y(e.$refs.message.$el)})}})}},watch:{chatId:function(e){""!==e&&this.init()}},components:{aMessage:E,headPortrait:c,friendDetailDialog:H}},Q={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return e.isShow&&""!==e.detailData?s("div",{staticClass:"chatWindow"},[s("friendDetailDialog",{attrs:{dialogFlag:e.friendDetailFlag,openData:e.friendDetailData},on:{"update:dialogFlag":function(t){e.friendDetailFlag=t}}}),e._v(" "),s("el-container",[s("el-main",{ref:"message",class:{small:this.$store.state.isVideo}},[s("div",{directives:[{name:"show",rawName:"v-show",value:e.isMessageLoading,expression:"isMessageLoading"}],staticClass:"loading-wrap"},[s("i",{staticClass:"el-icon-loading"})]),e._v(" "),s("div",{staticClass:"messageField"},[0!==e.total&&e.total<=e.messageRecord.length?s("p",[e._v("没有记录了")]):e._e(),e._v(" "),e._l(e.messageRecord,function(t,a){return s("aMessage",{key:a,attrs:{name:t.name,isAtRight:t.isAtRight,expressArr:e.expressArr,data:t},on:{imgClick:e.imgClick}})})],2)]),e._v(" "),s("el-footer",[s("div",{staticClass:"inputField"},[s("div",{staticClass:"input-menu"},[s("el-popover",{ref:"express",attrs:{"popper-class":"express-popover",placement:"top-start",trigger:"click"}},[s("div",{directives:[{name:"loading",rawName:"v-loading",value:e.isLoadingImage,expression:"isLoadingImage"}]},e._l(e.expressArr,function(t,a){return s("img",{key:t,ref:t.split(".")[0],refInFor:!0,attrs:{src:"http://"+e.$store.state.statisFileIp+"/express/"+t,alt:""},on:{click:function(t){e.clickExpress(a)}}})}))]),e._v(" "),s("i",{directives:[{name:"popover",rawName:"v-popover:express",arg:"express"}],staticClass:"fa fa-smile-o",attrs:{title:"表情"},on:{click:e.getExpress}}),e._v(" "),s("span",{staticClass:"upload-wrap",attrs:{title:"发送图片或视频"}},[s("el-upload",{ref:"uploadPic",attrs:{action:e.picAction,"on-success":e.picUpdateSuccess,"before-upload":e.beforePicUpload,limit:1}},[s("i",{staticClass:"el-icon-picture"})])],1),e._v(" "),1===e.chatType?s("i",{staticClass:"fa  fa-video-camera",attrs:{title:"视频通话"},on:{click:e.videoRequest}}):e._e(),e._v(" "),s("span",{staticClass:"upload-wrap",attrs:{title:"发送文件"}},[s("el-upload",{ref:"uploadFile",attrs:{action:e.fileAction,"on-success":e.fileUpdateSuccess,"before-upload":e.beforeFileUpload,limit:1}},[s("i",{staticClass:"el-icon-tickets"})])],1)],1),e._v(" "),s("div",{staticClass:"input-wrap"},[s("textarea",{directives:[{name:"model",rawName:"v-model",value:e.message,expression:"message"}],domProps:{value:e.message},on:{input:function(t){t.target.composing||(e.message=t.target.value)}}}),e._v(" "),s("button",{staticClass:"send-button",on:{click:e.sendMessage}},[e._v("发送")])])])])],1)],1):e._e()},staticRenderFns:[]};var J=s("Z0/y")(W,Q,!1,function(e){s("OmM3")},null,null).exports,Y={name:"groupManageDialog",props:["dialogFlag","openData"],data:function(){return{groupArr:[]}},computed:{},methods:{deleteGroup:function(e){var t=this;this.$http.post("/deleteGroup.do",{groupId:this.groupArr[e].value}).then(function(s){s.data.success&&(t.groupArr.splice(e,1),t.refresh())})},addGroup:function(){var e=this;this.$prompt("请输入组名","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(t){var s=t.value;s.length<=20?e.$http.post("/addGroup.do",{groupName:s,userId:e.$store.state.userId}).then(function(t){t.data.success&&(e.groupArr.push({name:s,value:t.data.data.insertId}),e.refresh())}):e.$message.error("请不要超过20字")})},refresh:function(){var e=this;R()(L.a.mark(function t(){return L.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$parent.getFriendGroup();case 2:return t.next=4,e.$parent.getFriend();case 4:case"end":return t.stop()}},t,e)}))()},open:function(){this.groupArr=JSON.parse(j()(this.openData))},close:function(){this.$emit("update:dialogFlag",!1)}},components:{dialogs:Z}},q={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"groupManageDialog"},[s("dialogs",{attrs:{dialogFlag:e.dialogFlag,openTitle:"分组管理",isDefaultBtn:!1},on:{"update:dialogFlag":function(t){e.dialogFlag=t},close:e.close,open:e.open}},[s("div",{attrs:{slot:"dialogContent"},slot:"dialogContent"},[s("div",{staticClass:"button-field"},[s("i",{staticClass:"fa fa-plus-circle"}),s("span",{on:{click:e.addGroup}},[e._v("添加分组")])]),e._v(" "),s("div",{staticClass:"content"},e._l(e.groupArr,function(t,a){return s("div",{key:a,staticClass:"group"},[s("span",[e._v(e._s(t.name))]),e._v(" "),s("el-button",{staticClass:"fr",attrs:{type:"danger",disabled:"我的好友"===t.name},on:{click:function(t){e.deleteGroup(a)}}},[e._v("删除")])],1)}))]),e._v(" "),s("div",{attrs:{slot:"footerButton"},slot:"footerButton"},[s("el-button",{attrs:{type:"primary"},on:{click:e.close}},[e._v("完成")])],1)])],1)},staticRenderFns:[]};var X={name:"addFriendDialog",props:["dialogFlag","friendList"],data:function(){return{checkedIndex:"",searchList:[],postParams:""}},methods:{open:function(){this.postParams="",this.searchList=[]},addFriend:function(e){var t=this,s={userId:sessionStorage.getItem("userId"),userName:this.$store.state.nickName,friendId:this.searchList[e].userId,friendPolicyType:this.searchList[e].friendPolicyType};if(0===this.searchList[e].friendPolicyType)this.$http.post("/addFriend.do",s).then(function(e){e.data.success&&("添加成功"===e.data.msg?(t.$message({message:e.data.msg,type:"success"}),t.$emit("update:dialogFlag",!1),R()(L.a.mark(function e(){return L.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$parent.getFriendGroup();case 2:return e.next=4,t.$parent.getFriend();case 4:case"end":return e.stop()}},e,t)}))()):t.$message.error(e.data.msg))});else{var a=1===this.searchList[e].friendPolicyType?"请输入验证密码":this.searchList[e].friendPolicyQuestion;this.$prompt(a,"好友验证",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(a){var r=a.value;["",null].includes(r)?t.$message.error("输入不能为空"):r.length>20?t.$message.error("输入不能超过20字"):(1===t.searchList[e].friendPolicyType?s.friendPolicyPassword=r:(s.friendPolicyAnswer=r,s.remark=t.searchList[e].friendPolicyQuestion),t.$http.post("/checkFriendRequest.do",s).then(function(a){a.data.success&&("验证成功"===a.data.msg?t.$http.post("/addFriend.do",s).then(function(e){e.data.success&&("添加成功"===e.data.msg?(t.$message({message:e.data.msg,type:"success"}),t.$emit("update:dialogFlag",!1),R()(L.a.mark(function e(){return L.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$parent.getFriendGroup();case 2:return e.next=4,t.$parent.getFriend();case 4:case"end":return e.stop()}},e,t)}))()):t.$message.error(e.data.msg))}):"好友请求已发送"===a.data.msg?(t.$message({message:a.data.msg,type:"success"}),t.$store.state.socket.emit("sendRemind",{toId:t.searchList[e].userId}),R()(L.a.mark(function e(){return L.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$parent.getFriendGroup();case 2:return e.next=4,t.$parent.getFriend();case 4:case"end":return e.stop()}},e,t)}))()):t.$message.error(a.data.msg))}))}).catch(function(){})}},search:function(){var e=this;""!==this.postParams?this.$http.post("/searchUserFuzzily.do",{idOrName:this.postParams}).then(function(t){if(t.data.success){var s=[];0!==t.data.data.length&&t.data.data.forEach(function(t){t.U_LoginID!==e.$store.state.userId&&s.push({userId:t.U_LoginID,nickName:t.U_NickName,age:t.U_Age,phone:t.U_Telephone,name:t.U_Name,status:t.U_UserStateID,friendPolicyType:t.U_FriendshipPolicyID,friendPolicyQuestion:t.U_FriendPolicyQuestion})}),e.searchList=s}}):this.$message.error("输入不能为空")},close:function(){this.$emit("update:dialogFlag",!1)}},components:{dialogs:Z,headPortrait:c}},K={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"addFriendDialog"},[s("dialogs",{attrs:{dialogFlag:e.dialogFlag,openTitle:"添加好友",isDefaultBtn:!1},on:{"update:dialogFlag":function(t){e.dialogFlag=t},close:e.close,open:e.open}},[s("div",{attrs:{slot:"dialogContent"},slot:"dialogContent"},[s("div",{staticClass:"search"},[s("el-input",{staticClass:"input-with-select",attrs:{maxlength:20,placeholder:"请输入对方账号或昵称"},model:{value:e.postParams,callback:function(t){e.postParams=t},expression:"postParams"}},[s("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.search},slot:"append"})],1)],1),e._v(" "),s("div",{staticClass:"search-result"},e._l(e.searchList,function(t,a){return s("div",{key:a,staticClass:"user clearfix",class:{checked:e.checkedIndex===a},on:{click:function(t){e.checkedIndex=a}}},[s("headPortrait",{attrs:{isSave:!0,status:t.status,userId:t.userId,hasDetail:!1,data:t}}),e._v(" "),s("div",{staticClass:"base-data fl"},[s("span",[e._v("ID:"+e._s(t.userId))]),e._v(" "),["",null].includes(t.nickName)?e._e():s("span",[e._v("昵称:"+e._s(t.nickName))]),e._v(" "),["",null].includes(t.age)?e._e():s("span",[e._v("年龄:"+e._s(t.age))]),e._v(" "),["",null].includes(t.phone)?e._e():s("span",[e._v("手机:"+e._s(t.phone))]),e._v(" "),["",null].includes(t.name)?e._e():s("span",[e._v("真实姓名:"+e._s(t.name))])]),e._v(" "),s("div",{staticClass:"operate fr"},[s("el-button",{attrs:{type:"primary",disabled:e.friendList.some(function(e){return e.friendId==t.userId})},on:{click:function(t){e.addFriend(a)}}},[e._v("\n              "+e._s(0!==e.friendList.filter(function(e){return e.friendId==t.userId}).length?e.friendList.filter(function(e){return e.friendId==t.userId})[0].type?"申请中":"已是好友":"添加好友")+"\n            ")])],1)],1)}))])])],1)},staticRenderFns:[]};var ee={name:"myFriend",data:function(){return{friendDetailFlag:!1,isFilterFriendShow:!1,searchParams:"",selectedOptions:[],options:[{label:"修改备注",value:"1"},{label:"移至分组",value:"2"},{label:"删除好友",value:"3"}],friendList:[],addFlag:!1,groupFlag:!1,friendGroup:[],curFriendId:"",expressArr:[],friendDetailData:{},isSocketListen:!1}},computed:{socket:function(){return this.$store.state.socket},filterFriend:function(){var e=this;return""===this.searchParams?[]:this.friendList.filter(function(t){return-1!==t.friendId.indexOf(e.searchParams)||t.nickName&&-1!==t.nickName.indexOf(e.searchParams)||t.remark&&-1!==t.remark.indexOf(e.searchParams)})}},mounted:function(){var e=this;R()(L.a.mark(function t(){var s;return L.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getFriendGroup();case 2:return t.next=4,e.getFriend();case 4:void 0!==e.$route.params.friendId&&(e.$store.state.myFriendCheckedId=e.$route.params.friendId,s=e.friendGroup.filter(function(t){return t.content.some(function(t){return t.friendId===e.$store.state.myFriendCheckedId})})[0],e.$refs.friendMenu.open(s.value),e.select(e.$route.params.friendId,[s.value,e.$route.params.friendId]));case 5:case"end":return t.stop()}},t,e)}))()},activated:function(){var e=this;R()(L.a.mark(function t(){var s;return L.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getFriendGroup();case 2:return t.next=4,e.getFriend();case 4:void 0!==e.$route.params.friendId&&(e.$store.state.myFriendCheckedId=e.$route.params.friendId,s=e.friendGroup.filter(function(t){return t.content.some(function(t){return t.friendId===e.$store.state.myFriendCheckedId})})[0],e.$refs.friendMenu.open(s.value),e.select(e.$route.params.friendId,[s.value,e.$route.params.friendId]));case 5:case"end":return t.stop()}},t,e)}))()},methods:{imgClick:function(e){var t=this;this.$http.post("/getUserInfo.do",{userId:e}).then(function(e){e.data.success&&(t.friendDetailData={userId:e.data.data[0].U_LoginID,nickName:e.data.data[0].U_NickName,age:e.data.data[0].U_Age,birthday:e.data.data[0].U_Birthday,phone:e.data.data[0].U_Telephone,email:e.data.data[0].U_Email,name:e.data.data[0].U_Name,sex:e.data.data[0].U_Sex},t.friendDetailFlag=!0)})},goTofriend:function(e){this.$refs.friendMenu.open(e.friendGroupsId),this.select(e.friendId,[e.friendGroupsId,e.friendId]),this.searchParams=""},handleChange:function(e,t){var s=this;if(""!=this.selectedOptions){"1"===this.selectedOptions[0]?this.$prompt(" ","修改备注",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(a){var r=a.value;r.length<=20?R()(L.a.mark(function a(){return L.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,s.reviseRemark(s.friendGroup[e].content[t].friendId,r);case 2:s.getFriend();case 3:case"end":return a.stop()}},a,s)}))():s.$message.error("请不要超过20字")}):"2"===this.selectedOptions[0]?R()(L.a.mark(function a(){return L.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,s.changeGroup(s.friendGroup[e].content[t].friendId,s.selectedOptions[1]);case 2:s.getFriend();case 3:case"end":return a.stop()}},a,s)}))():R()(L.a.mark(function a(){return L.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,s.deleteFriend(s.friendGroup[e].content[t].friendId);case 2:s.$store.state.myFriendCheckedId===s.friendGroup[e].content[t].friendId&&(s.$store.state.myFriendCheckedId=""),s.$store.state.socket.emit("sendRemind",{toId:s.friendGroup[e].content[t].friendId}),s.getFriend();case 5:case"end":return a.stop()}},a,s)}))();var a={stopPropagation:function(){}};this.$refs["friendMenu"+e+"-"+t][0].clearValue(a)}},deleteFriend:function(e){var t=this;return new T.a(function(s){t.$http.post("/deleteFriend.do",{userId:sessionStorage.getItem("userId"),userName:t.$store.state.nickName,friendId:e}).then(function(e){e.data.success&&(t.$message({message:"删除成功",type:"success"}),s())})})},changeGroup:function(e,t){var s=this;return new T.a(function(a){s.$http.post("/changeGroup.do",{userId:sessionStorage.getItem("userId"),friendId:e,friendGroupsId:t}).then(function(e){e.data.success&&(s.$message({message:'已移至"'+s.friendGroup.filter(function(e){return e.value===t})[0].name+'"',type:"success"}),a())})})},reviseRemark:function(e,t){var s=this;return new T.a(function(a){s.$http.post("/reviseRemark.do",{userId:sessionStorage.getItem("userId"),friendId:e,name:t}).then(function(e){e.data.success&&(s.$message({message:"修改成功",type:"success"}),a())})})},openGroupManageDialog:function(){this.groupFlag=!0},openAddFriendDialog:function(){this.addFlag=!0},openGroupMenu:function(e){e.button},select:function(e,t){this.$store.state.myFriendCheckedId!=e&&(this.$store.state.myFriendCheckedId=e)},getFriend:function(){var e=this;return new T.a(function(t){e.friendList=[],e.$http.post("/getFriend.do",{userId:sessionStorage.getItem("userId")}).then(function(s){s.data.success&&(e.friendGroup.forEach(function(t,s){e.friendGroup[s].content=[]}),s.data.data.forEach(function(t){var s=e.friendGroup.filter(function(e){return e.value===t.F_FriendGroupsID});1===s.length?(s[0].content.push({remark:t.F_Name,nickName:t.U_NickName,friendId:t.F_FriendID,status:t.U_UserStateID,friendGroupsId:t.F_FriendGroupsID}),e.friendList.push({remark:t.F_Name,nickName:t.U_NickName,friendId:t.F_FriendID,status:t.U_UserStateID,friendGroupsId:t.F_FriendGroupsID})):(e.friendGroup[0].content.push({remark:t.F_Name,nickName:t.U_NickName,friendId:t.F_FriendID,status:t.U_UserStateID,friendGroupsId:e.friendGroup[0].value}),e.friendList.push({remark:t.F_Name,nickName:t.U_NickName,friendId:t.F_FriendID,status:t.U_UserStateID,friendGroupsId:e.friendGroup[0].value}))}),t())}),e.$http.post("/getYourFriendRequest.do",{userId:sessionStorage.getItem("userId")}).then(function(s){s.data.success&&(s.data.data.forEach(function(t,s){e.friendList.push({remark:t.F_Name,nickName:t.U_NickName,friendId:t.UM_ToID,type:1})}),t())})})},getFriendGroup:function(){var e=this;return new T.a(function(t){e.$http.post("/getFriendGroup.do",{userId:sessionStorage.getItem("userId")}).then(function(s){if(s.data.success){var a=[];e.options[1].children=[],s.data.data.forEach(function(t,s){e.options[1].children.push({label:t.FG_Name,value:t.FG_ID}),a.push({name:t.FG_Name,value:t.FG_ID,content:[]})}),e.friendGroup=a,t()}})})}},watch:{socket:{handler:function(e,t){var s=this;e&&!1===this.isSocketListen&&(e.on("refreshFriend",function(){R()(L.a.mark(function e(){return L.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.getFriendGroup();case 2:return e.next=4,s.getFriend();case 4:case"end":return e.stop()}},e,s)}))()}),this.isSocketListen=!0)},deep:!0}},components:{aMessage:E,groupManageDialog:s("Z0/y")(Y,q,!1,function(e){s("HM/m")},null,null).exports,addFriendDialog:s("Z0/y")(X,K,!1,function(e){s("EZj7")},null,null).exports,headPortrait:c,friendDetailDialog:H,chatWindow:J}},te={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"myFriend",on:{mousedown:e.openGroupMenu}},[s("groupManageDialog",{attrs:{dialogFlag:e.groupFlag,openData:e.friendGroup},on:{"update:dialogFlag":function(t){e.groupFlag=t}}}),e._v(" "),s("addFriendDialog",{attrs:{dialogFlag:e.addFlag,friendList:e.friendList},on:{"update:dialogFlag":function(t){e.addFlag=t}}}),e._v(" "),s("friendDetailDialog",{attrs:{dialogFlag:e.friendDetailFlag,openData:e.friendDetailData},on:{"update:dialogFlag":function(t){e.friendDetailFlag=t}}}),e._v(" "),s("el-container",[s("el-aside",{attrs:{width:"200px"}},[s("div",{staticClass:"operate"},[s("i",{staticClass:"el-icon-plus fr",on:{click:e.openAddFriendDialog}}),e._v(" "),s("i",{staticClass:"fa fa-bars fr",on:{click:e.openGroupManageDialog}})]),e._v(" "),s("div",{staticClass:"search-wrap"},[s("el-input",{attrs:{maxlength:20,placeholder:"请输入好友账号或昵称进行搜索"},on:{focus:function(t){e.isFilterFriendShow=!0},blur:function(t){e.isFilterFriendShow=!1}},model:{value:e.searchParams,callback:function(t){e.searchParams=t},expression:"searchParams"}}),e._v(" "),s("ul",{staticClass:"filter-friend-wrap",class:{hasFriend:0!==e.filterFriend.length,friendWrapHide:!e.isFilterFriendShow}},e._l(e.filterFriend,function(t){return s("li",{on:{click:function(s){e.goTofriend(t)}}},[s("headPortrait",{attrs:{indexPath:t.friendId,isSave:!0,status:t.status,userId:t.friendId,hasDetail:!0,data:t},on:{imgClick:e.imgClick}}),e._v(" "),s("span",{class:{lowColor:0===t.status,isActive:t.friendId===e.$store.state.myFriendCheckedId},attrs:{title:t.remark||t.nickName||t.friendId}},[e._v(e._s(t.remark||t.nickName||t.friendId))])],1)}))],1),e._v(" "),s("div",{staticClass:"my-group"},[s("el-menu",{ref:"friendMenu",staticClass:"el-menu-vertical-demo",attrs:{"default-active":"","background-color":"#545c64","text-color":"#fff","active-text-color":"#ffd04b"},on:{select:e.select}},e._l(e.friendGroup,function(t,a){return s("el-submenu",{key:t.value,attrs:{index:t.value+""}},[s("template",{slot:"title"},[s("span",[e._v(e._s(t.name))])]),e._v(" "),e._l(t.content,function(t,r){return s("el-menu-item",{key:t.friendId,attrs:{index:t.friendId}},[s("div",[s("headPortrait",{attrs:{indexPath:t.friendId,status:t.status,userId:t.friendId,hasDetail:!0,data:t},on:{imgClick:e.imgClick}}),e._v(" "),s("span",{class:{lowColor:0===t.status,isActive:t.friendId===e.$store.state.myFriendCheckedId},attrs:{title:t.remark||t.nickName||t.friendId}},[e._v(e._s(t.remark||t.nickName||t.friendId))]),e._v(" "),s("div",{staticClass:"cascader",on:{click:function(e){e.stopPropagation()}}},[s("el-cascader",{ref:"friendMenu"+a+"-"+r,refInFor:!0,attrs:{options:e.options},on:{change:function(t){e.handleChange(a,r)}},model:{value:e.selectedOptions,callback:function(t){e.selectedOptions=t},expression:"selectedOptions"}})],1)],1)])})],2)}))],1)]),e._v(" "),""!==e.$store.state.myFriendCheckedId?s("chatWindow",{attrs:{chatId:e.$store.state.myFriendCheckedId,chatType:1}}):e._e()],1)],1)},staticRenderFns:[]};var se=s("Z0/y")(ee,te,!1,function(e){s("QxDx")},null,null).exports,ae={name:"createGroupDialog",props:["dialogFlag"],data:function(){return{imageUrl:"",fileList:[],groupName:"",groupId:"",groupIdTip:0,groupNameTip:0}},mounted:function(){},methods:{open:function(){this.fileList=[],this.groupName="",this.groupId="",this.groupNameTip="",this.groupIdTip="",this.imageUrl=""},translateGroupIdTip:function(e){switch(e){case 1:return"输入不能为空";case 2:return"可以使用";case 3:return"该ID以被注册";default:return null}},checkGroupName:function(){""===this.groupName?this.groupNameTip=1:this.groupNameTip=0},checkGroupId:function(){var e=this;""!==this.groupId?this.$http.post("/checkGroupId.do",{groupId:this.groupId}).then(function(t){t.data.success?e.groupIdTip=2:e.groupIdTip=3}):this.groupIdTip=1},createGroup:function(){var e=!1;2!==this.groupIdTip&&(0===this.groupIdTip&&(this.groupIdTip=1),e=!0),""===this.groupName&&(this.groupNameTip=1,e=!0),0!==this.fileList.length?!e&&this.$refs.uploadGroupIcon.submit():this.$message.error("请设置群图标")},change:function(e,t){var s=e.name.split("."),a=s[s.length-1].toLowerCase(),r=e.size/1024/1024<2,i=/jpeg|bmp|jpg|png|gif/i.test(a);!r&&this.$message.error("图片不能超过2Mb"),!i&&this.$message.error("不识别此格式文件"),r&&i?(this.fileList=[t[t.length-1]],this.imageUrl=URL.createObjectURL(e.raw)):this.fileList=[t[0]]},onUploading:function(e,t,s){console.log(e),console.log(t),console.log(s)},handleAvatarSuccess:function(e,t){var s=this;e.success&&this.$http.post("/createGroup.do",{groupId:this.groupId,groupName:this.groupName,userId:this.$store.state.userId,nickName:this.$store.state.nickName,icon:e.data}).then(function(e){e.data.success&&(s.$message({message:"创建群成功",type:"success"}),s.$emit("update:dialogFlag",!1),s.$parent.getAllGroups())})},beforeAvatarUpload:function(e){console.log(e);var t=e.name.split("."),s=t[t.length-1].toLowerCase(),a=e.size/1024/1024<2,r=/jpeg|bmp|jpg|png|gif/i.test(s);return!a&&this.$message.error("图片不能超过2Mb"),!r&&this.$message.error("不识别此格式文件"),r&&a},close:function(){this.$emit("update:dialogFlag",!1)}},components:{dialogs:Z}},re={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"createGroupDialog"},[s("dialogs",{attrs:{dialogFlag:e.dialogFlag,openTitle:"创建群",isDefaultBtn:!1},on:{"update:dialogFlag":function(t){e.dialogFlag=t},close:e.close,open:e.open}},[s("div",{attrs:{slot:"dialogContent"},slot:"dialogContent"},[s("div",{staticClass:"upload-wrap"},[s("el-upload",{ref:"uploadGroupIcon",staticClass:"avatar-uploader",attrs:{"auto-upload":!1,"show-file-list":!1,data:{groupId:e.groupId,groupName:e.groupName,userId:e.$store.state.userId},action:"/uploadGroupIcon.do?groupId="+e.groupId,"file-list":e.fileList,"on-change":e.change,"on-progress":e.onUploading,"on-success":e.handleAvatarSuccess,"before-upload":e.beforeAvatarUpload}},[e.imageUrl?s("img",{staticClass:"avatar",attrs:{src:e.imageUrl}}):s("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),e._v(" "),s("div",{staticClass:"input-group"},[s("el-row",[s("el-input",{attrs:{maxlength:20,placeholder:"请写群ID"},on:{blur:e.checkGroupId},model:{value:e.groupId,callback:function(t){e.groupId=t},expression:"groupId"}}),e._v(" "),s("span",{class:{groupTip:!0,isError:[1,3].includes(e.groupIdTip)}},[e._v(e._s(e.translateGroupIdTip(e.groupIdTip)))])],1),e._v(" "),s("el-row",[s("el-input",{attrs:{maxlength:20,placeholder:"请写群名称"},on:{blur:e.checkGroupName},model:{value:e.groupName,callback:function(t){e.groupName=t},expression:"groupName"}}),e._v(" "),s("span",{class:{groupTip:!0,isError:[1,3].includes(e.groupNameTip)}},[e._v(e._s(e.translateGroupIdTip(e.groupNameTip)))])],1),e._v(" "),s("el-row",[s("el-button",{attrs:{type:"primary"},on:{click:e.createGroup}},[e._v("创建")])],1)],1)])])],1)},staticRenderFns:[]};var ie=s("Z0/y")(ae,re,!1,function(e){s("QZmy")},null,null).exports,oe={name:"groupDetailDialog",props:["dialogFlag","openData","groupsList"],data:function(){return{fileList:[],imageUrl:"",params:{groupNick:"",groupIntro:"",groupName:""},friendGroup:[],friendDetailData:{},friendDetailFlag:!1,isInviteLoading:!1}},methods:{open:function(){var e=this;this.fileList=[{name:"groupIcon",url:"http://"+this.$store.state.statisFileIp+this.openData.groupIcon}],this.imageUrl="http://"+this.$store.state.statisFileIp+this.openData.groupIcon,console.log(this.openData),this.params.groupIntro=this.openData.groupIntro,this.params.groupName=this.openData.groupName,this.params.groupNick=this.openData.members.filter(function(t){return t.memberId===e.$store.state.userId})[0]&&this.openData.members.filter(function(t){return t.memberId===e.$store.state.userId})[0].groupNick||this.$store.state.nickName||this.$store.state.userId},imgClick:function(e){var t=this;this.$http.post("/getUserInfo.do",{userId:e}).then(function(e){e.data.success&&(t.friendDetailData={userId:e.data.data[0].U_LoginID,nickName:e.data.data[0].U_NickName,age:e.data.data[0].U_Age,birthday:e.data.data[0].U_Birthday,phone:e.data.data[0].U_Telephone,email:e.data.data[0].U_Email,name:e.data.data[0].U_Name,sex:e.data.data[0].U_Sex},t.friendDetailFlag=!0)})},requestJoinGroup:function(){var e=this,t=JSON.parse(j()(this.openData));delete t.members;var s={userId:sessionStorage.getItem("userId"),userName:this.$store.state.nickName,group:t};this.$http.post("/requestJoinGroup.do",s).then(function(t){t.data.success&&(e.$message({message:"发送请求成功",type:"success"}),e.$parent.getAllGroups())})},changeAdmin:function(e){var t=this;this.$http.post("/changeAdmin.do",{groupId:this.openData.groupId,adminId:e.memberId,userId:this.$store.state.userId}).then(function(s){s.data.success&&(t.$message({message:"群主权限已转移",type:"success"}),t.openData.members=t.openData.members.map(function(s){return s.memberId===t.$store.state.userId&&(s.authority=3),s.memberId===e.memberId&&(s.authority=1),s}),t.openData.adminId=e.memberId)})},moveOutMember:function(e){var t=this;this.$http.post("/moveOutMember.do",{groupId:this.openData.groupId,userId:e.memberId}).then(function(s){s.data.success&&(t.$message({message:"请离成功",type:"success"}),t.openData.members=t.openData.members.filter(function(t){return t.memberId!==e.memberId}))})},quitGroup:function(){var e=this;if(1===this.openData.members.length)this.$confirm("群中只剩你一人，是否解散此群?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then(function(){e.dismissGroup()});else{if(this.openData.adminId===this.$store.state.userId)return void this.$message.error({message:"请移交群主职位后，再退出！"});var t={groupId:this.openData.groupId,userId:this.$store.state.userId};this.$http.post("/quitGroup.do",t).then(function(t){t.data.success&&(e.$message({message:"成功退出",type:"success"}),e.$parent.getAllGroups(),e.$emit("update:dialogFlag",!1))})}},dismissGroup:function(){var e=this;this.$http.post("/dismissGroup.do",{groupId:this.openData.groupId,userId:this.$store.state.userId}).then(function(t){t.data.success&&(e.$message({message:"成功解散",type:"success"}),e.$parent.getAllGroups(),e.$emit("update:dialogFlag",!1))})},saveGroupDetail:function(){var e=this;""!==this.params.groupNick?this.$http.post("/saveGroupDetail.do",{userId:this.$store.state.userId,groupId:this.openData.groupId,groupName:this.params.groupName,groupNick:this.params.groupNick,groupIntro:this.params.groupIntro}).then(function(t){t.data.success&&(e.$message({message:"保存成功",type:"success"}),e.$parent.getAllGroups(),e.$emit("update:dialogFlag",!1))}):this.$message.error("群片名不能为空")},select:function(e){var t=this;if(this.openData.members.some(function(t){return t.memberId===e}))this.$message.error("该用户已在群中");else if(this.isInviteLoading)this.$message.error("正在发送邀请，请稍等！");else{var s=JSON.parse(j()(this.openData));delete s.members,this.isInviteLoading=!0,this.$http.post("/inviteGroup.do",{toId:e,fromId:this.$store.state.userId,remark:s,fromName:this.$store.state.nickName}).then(function(a){a.data.success&&(t.$message({message:"已发送邀请",type:"success"}),t.$store.state.socket.emit("sendRemind",{toId:e,fromId:t.$store.state.userId,remark:s,fromName:t.$store.state.nickName,messageType:6})),t.isInviteLoading=!1}).catch(function(){t.isInviteLoading=!1})}},handleChange:function(){},getFriend:function(){var e=this;return new T.a(function(t){e.$http.post("/getFriend.do",{userId:sessionStorage.getItem("userId")}).then(function(s){s.data.success&&(e.friendGroup.forEach(function(t,s){e.friendGroup[s].content=[]}),s.data.data.forEach(function(t){e.friendGroup.forEach(function(s,a){s.value==t.F_FriendGroupsID&&e.friendGroup[a].content.push({remark:t.F_Name,nickName:t.U_NickName,friendId:t.F_FriendID})})}),t())})})},getFriendGroup:function(){var e=this;return new T.a(function(t){e.$http.post("/getFriendGroup.do",{userId:e.$store.state.userId}).then(function(s){if(s.data.success){var a=[];s.data.data.forEach(function(e,t){a.push({name:e.FG_Name,value:e.FG_ID,content:[]})}),e.friendGroup=a,t()}})})},show:function(){var e=this;R()(L.a.mark(function t(){return L.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getFriendGroup();case 2:return t.next=4,e.getFriend();case 4:case"end":return t.stop()}},t,e)}))()},change:function(e,t){var s=e.name.split("."),a=s[s.length-1].toLowerCase(),r=e.size/1024/1024<2,i=/jpeg|bmp|jpg|png|gif/i.test(a);!r&&this.$message.error("图片不能超过2Mb"),!i&&this.$message.error("不识别此格式文件"),r&&i?(this.fileList=[t[t.length-1]],this.imageUrl=URL.createObjectURL(e.raw),this.$refs.uploadGroupIcon.submit()):this.fileList=[t[0]]},handleAvatarSuccess:function(e,t){e.success&&(this.$message({message:"群头像设置成功",type:"success"}),document.getElementsByClassName("group"+this.openData.groupId)[0].getElementsByTagName("img")[1].src="http://"+this.$store.state.statisFileIp+e.data.replace(/\\/g,"/").split("/data")[1]+"?time="+(new Date).getTime())},close:function(){this.$emit("update:dialogFlag",!1)}},components:{dialogs:Z,headPortrait:c,friendDetailDialog:H}},ne={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"groupDetailDialog"},[s("friendDetailDialog",{attrs:{dialogFlag:e.friendDetailFlag,openData:e.friendDetailData},on:{"update:dialogFlag":function(t){e.friendDetailFlag=t}}}),e._v(" "),s("dialogs",{attrs:{dialogFlag:e.dialogFlag,openTitle:"ID:"+e.openData.groupId,isDefaultBtn:!1},on:{"update:dialogFlag":function(t){e.dialogFlag=t},close:e.close,open:e.open}},[s("div",{attrs:{slot:"dialogContent"},slot:"dialogContent"},[s("div",{staticClass:"upload-wrap"},[s("el-upload",{ref:"uploadGroupIcon",staticClass:"avatar-uploader",attrs:{disabled:e.openData.adminId!==e.$store.state.userId,"show-file-list":!1,"auto-upload":!1,action:"/uploadGroupIcon.do?groupId="+e.openData.groupId,"file-list":e.fileList,"on-change":e.change,"on-success":e.handleAvatarSuccess}},[e.imageUrl?s("img",{staticClass:"avatar",attrs:{src:e.imageUrl}}):s("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),e._v(" "),s("div",{staticClass:"group-nick"},[s("el-row",[s("el-col",{attrs:{span:17}},[s("span",[e._v("群名：")])]),e._v(" "),s("el-col",{attrs:{span:7}},[e.$store.state.userId!==e.openData.adminId?s("span",[e._v(e._s(e.params.groupName))]):s("el-input",{attrs:{maxlength:20},model:{value:e.params.groupName,callback:function(t){e.$set(e.params,"groupName",t)},expression:"params.groupName"}})],1)],1)],1),e._v(" "),e.openData.members&&e.openData.members&&e.openData.members.some(function(t){return t.memberId===e.$store.state.userId})?s("div",{staticClass:"group-nick"},[s("el-row",[s("el-col",{attrs:{span:17}},[s("span",[e._v("我的群片名：")])]),e._v(" "),s("el-col",{attrs:{span:7}},[s("el-input",{attrs:{maxlength:20},model:{value:e.params.groupNick,callback:function(t){e.$set(e.params,"groupNick",t)},expression:"params.groupNick"}})],1)],1)],1):e._e(),e._v(" "),s("el-popover",{ref:"members",attrs:{"popper-class":"members-popover",placement:"right",trigger:"click"}},[s("el-popover",{ref:"friendList",attrs:{"popper-class":"friends-popover",placement:"left",trigger:"click"},on:{show:e.show}},[s("div",{staticClass:"my-group"},[s("el-menu",{staticClass:"el-menu-vertical-demo",attrs:{"default-active":"2","background-color":"#FFFFFF","text-color":"#606266","active-text-color":"#606266"},on:{select:e.select}},e._l(e.friendGroup,function(t,a){return s("el-submenu",{key:a,attrs:{index:t.value+""}},[s("template",{slot:"title"},[s("span",[e._v(e._s(t.name))])]),e._v(" "),e._l(t.content,function(t,a){return s("el-menu-item",{key:a,attrs:{index:t.friendId}},[s("div",[s("headPortrait",{attrs:{indexPath:t.friendId,isSave:!0,userId:t.friendId},on:{imgClick:e.imgClick}}),e._v("\n                    "+e._s(t.remark||t.nickName||t.friendId)+"\n                  ")],1)])})],2)}))],1)]),e._v(" "),e.openData.members&&e.openData.members.some(function(t){return t.memberId===e.$store.state.userId})?s("div",{directives:[{name:"popover",rawName:"v-popover:friendList",arg:"friendList"}]},[s("i",{staticClass:"el-icon-plus"}),s("span",[e._v("邀请新成员")])]):e._e(),e._v(" "),s("div",{staticClass:"table-box"},[s("ul",e._l(e.openData.members,function(t){return s("li",{key:t.memberId},[s("el-row",[s("el-col",{attrs:{span:8}},[s("headPortrait",{attrs:{indexPath:t.memberId,userId:t.memberId},on:{imgClick:e.imgClick}})],1),e._v(" "),s("el-col",{attrs:{span:8}},[e._v(e._s(t.groupNick||t.memberId))]),e._v(" "),s("el-col",{attrs:{span:8}},[s("span",[e._v(e._s(1===t.authority?"群主":3===t.authority?"群员":""))])])],1),e._v(" "),s("div",{staticClass:"operation"},[e.openData.adminId===e.$store.state.userId&&e.openData.adminId!==t.memberId?s("a",{attrs:{href:"javascript:;",title:"移交群主"},on:{click:function(s){e.changeAdmin(t)}}},[e._v("移交")]):e._e(),e._v(" "),e.$store.state.userId===t.memberId?s("a",{attrs:{href:"javascript:;",title:"退出该群"},on:{click:e.quitGroup}},[e._v("退出")]):e._e(),e._v(" "),e.openData.adminId===e.$store.state.userId&&e.openData.adminId!==t.memberId?s("a",{attrs:{href:"javascript:;",title:"请离该群"},on:{click:function(s){e.moveOutMember(t)}}},[e._v("请离")]):e._e()])],1)}))])],1),e._v(" "),s("div",{directives:[{name:"popover",rawName:"v-popover:members",arg:"members"}],staticClass:"member-wrap"},[s("span",[e._v("群成员")]),e._v(" "),s("i",{staticClass:"el-icon-arrow-right"})]),e._v(" "),s("div",{staticClass:"group-intro"},[s("el-row",[s("el-col",{attrs:{span:24}},[e._v("群介绍：")]),e._v(" "),s("el-col",{attrs:{span:23,offset:1}},[s("p",[e._v("本群创建于"+e._s(new Date(parseInt(e.openData.createTime,10)).toLocaleString().split(" ")[0]))]),e._v(" "),e.$store.state.userId===e.openData.adminId?s("el-input",{attrs:{type:"textarea",placeholder:"请输入群介绍"},model:{value:e.params.groupIntro,callback:function(t){e.$set(e.params,"groupIntro",t)},expression:"params.groupIntro"}}):s("span",[e._v(e._s(e.openData.groupIntro))])],1)],1)],1),e._v(" "),s("div",{staticClass:"button"},[e.openData.members&&e.openData.members.some(function(t){return t.memberId===e.$store.state.userId})?s("el-button",{attrs:{type:"primary"},on:{click:e.saveGroupDetail}},[e._v("保存\n        ")]):e._e(),e._v(" "),e.openData.members&&e.openData.members.some(function(t){return t.memberId===e.$store.state.userId})?s("el-button",{attrs:{type:"primary"},on:{click:e.quitGroup}},[e._v("退出本群\n        ")]):e._e(),e._v(" "),e.$store.state.userId===e.openData.adminId?s("el-button",{attrs:{type:"primary"},on:{click:e.dismissGroup}},[e._v("解散本群")]):e._e()],1)],1)])],1)},staticRenderFns:[]};var de=s("Z0/y")(oe,ne,!1,function(e){s("doAy")},null,null).exports,ce={name:"searchGroupsDialog",props:["dialogFlag","groupsList"],data:function(){return{postParams:"",checkedIndex:"",searchList:[]}},methods:{open:function(){this.postParams="",this.searchList=[]},requestJoinGroup:function(e){var t=this,s={userId:sessionStorage.getItem("userId"),userName:this.$store.state.nickName,group:this.searchList[e]};this.$http.post("/requestJoinGroup.do",s).then(function(s){s.data.success&&(t.$message({message:"发送请求成功",type:"success"}),t.$parent.getAllGroups(),t.$store.state.socket.emit("sendRemind",{toId:t.searchList[e].groupId,type:2}))})},search:function(){var e=this;""!==this.postParams?this.$http.post("/searchGroupsFuzzily.do",{idOrName:this.postParams}).then(function(t){if(t.data.success){var s=[];0!==t.data.data.length&&t.data.data.forEach(function(e){s.push({groupId:e.UG_ID,groupIcon:e.UG_Icon,groupName:e.UG_Name})}),e.searchList=s}}):this.$message.error("输入不能为空")},close:function(){this.$emit("update:dialogFlag",!1)}},components:{dialogs:Z,headPortrait:c}},le={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"searchGroupsDialog"},[s("dialogs",{attrs:{dialogFlag:e.dialogFlag,openTitle:"搜索群",isDefaultBtn:!1},on:{"update:dialogFlag":function(t){e.dialogFlag=t},close:e.close,open:e.open}},[s("div",{attrs:{slot:"dialogContent"},slot:"dialogContent"},[s("div",{staticClass:"search"},[s("el-input",{staticClass:"input-with-select",attrs:{maxlength:20,placeholder:"请输入群ID或名称"},model:{value:e.postParams,callback:function(t){e.postParams=t},expression:"postParams"}},[s("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.search},slot:"append"})],1)],1),e._v(" "),s("div",{staticClass:"search-result"},e._l(e.searchList,function(t,a){return s("div",{key:a,staticClass:"user clearfix",class:{checked:e.checkedIndex===a},on:{click:function(t){e.checkedIndex=a}}},[s("headPortrait",{attrs:{isSave:!0,imgUrl:t.groupIcon},on:{imgClick:function(s){e.$parent.imgClick(t.groupId)}}}),e._v(" "),s("div",{staticClass:"base-data fl"},[s("p",[e._v("ID:"+e._s(t.groupId))]),e._v(" "),["",null].includes(t.groupName)?e._e():s("p",[e._v("名称:"+e._s(t.groupName))])]),e._v(" "),s("div",{staticClass:"operate fr"},[s("el-button",{attrs:{type:"primary",disabled:e.groupsList.requestGroup.some(function(e){return e.groupId==t.groupId})||e.groupsList.joinGroup.some(function(e){return e.groupId==t.groupId})||e.groupsList.createGroup.some(function(e){return e.groupId==t.groupId})},on:{click:function(t){e.requestJoinGroup(a)}}},[e._v("\n              "+e._s(e.groupsList.requestGroup.some(function(e){return e.groupId==t.groupId})?"已申请":e.groupsList.joinGroup.some(function(e){return e.groupId==t.groupId})||e.groupsList.createGroup.some(function(e){return e.groupId==t.groupId})?"已在群中":"申请加入")+"\n            ")])],1)],1)}))])])],1)},staticRenderFns:[]};var ue={name:"myGroups",data:function(){return{isFilterGroupShow:!1,searchParams:"",groupsList:{createGroup:[],joinGroup:[],requestGroup:[]},selectedOptions:[],options:[{label:"修改备注",value:"1"},{label:"移至分组",value:"2"},{label:"删除好友",value:"3"}],curGroupId:"",expressArr:[],searchGroupsFlag:!1,createGroupFlag:!1,groupDetailFlag:!1,groupDetailData:{},friendDetailFlag:!1,friendDetailData:{},isSocketListen:!1}},computed:{filterGroup:function(){var e=this;if(""===this.searchParams)return[];var t=this.groupsList.createGroup.filter(function(t){return-1!==t.groupId.indexOf(e.searchParams)||-1!==t.groupName.indexOf(e.searchParams)}),s=this.groupsList.joinGroup.filter(function(t){return-1!==t.groupId.indexOf(e.searchParams)||-1!==t.groupName.indexOf(e.searchParams)});return console.log(t),console.log(s),t.concat(s)},curGroup:function(){var e=this;return""===this.$store.state.myGroupCheckedId||0===this.groupsList.createGroup.length&&0===this.groupsList.joinGroup.length?{}:this.groupsList.createGroup.filter(function(t){return t.groupId===e.$store.state.myGroupCheckedId})[0]||this.groupsList.joinGroup.filter(function(t){return t.groupId===e.$store.state.myGroupCheckedId})[0]},socket:function(){return this.$store.state.socket}},mounted:function(){var e=this;this.getAllGroups().then(function(){if(void 0!==e.$route.params.groupId){var t=e.groupsList.createGroup.some(function(t){return t.groupId===e.$route.params.groupId});e.$refs.groupMenu.open(t?"0":"1"),e.select(e.$route.params.groupId,[t?"0":"1",e.$route.params.groupId])}})},activated:function(){var e=this;this.getAllGroups().then(function(){if(void 0!==e.$route.params.groupId){var t=e.groupsList.createGroup.some(function(t){return t.groupId===e.$route.params.groupId});e.$refs.groupMenu.open(t?"0":"1"),e.select(e.$route.params.groupId,[t?"0":"1",e.$route.params.groupId])}})},methods:{goToGroup:function(e){this.$refs.groupMenu.open(e.groupAdminId===this.$store.state.userId?"0":"1"),this.select(e.groupId,[e.groupAdminId===this.$store.state.userId?"0":"1",e.groupId]),this.searchParams=""},getGroupDetailData:function(e){return this.$http.post("/getGroupDetailData.do",{groupId:e})},getGroupMembers:function(e){return this.$http.post("/getGroupMembers.do",{groupId:e})},imgClick:function(e){var t=this;T.a.all([this.getGroupDetailData(e),this.getGroupMembers(e)]).then(function(e){e[0].data.success&&e[1].data.success&&(t.groupDetailData={groupId:e[0].data.data[0].UG_ID,groupName:e[0].data.data[0].UG_Name,groupIntro:e[0].data.data[0].UG_Intro,groupNotice:e[0].data.data[0].UG_Notice,groupIcon:e[0].data.data[0].UG_Icon,createTime:e[0].data.data[0].UG_CreateTime,adminId:e[0].data.data[0].UG_AdminID,members:[]},e[1].data.data.forEach(function(e){t.groupDetailData.members.push({groupNick:e.UGU_GroupNick,memberId:e.UGU_UserID,joinTime:e.UGU_CreateTime,authority:e.UGU_Authority})}),t.groupDetailFlag=!0)})},select:function(e,t){this.$store.state.myGroupCheckedId!==e&&(this.$store.state.myGroupCheckedId=e)},getAllGroups:function(){var e=this;return new T.a(function(t){T.a.all([e.$http.post("/getAllGroups.do",{userId:sessionStorage.getItem("userId")}),e.$http.post("/getYourGroupRequest.do",{userId:sessionStorage.getItem("userId")})]).then(function(s){if(s[0].data.success&&s[1].data.success){var a={createGroup:[],joinGroup:[],requestGroup:[]};s[0].data.data.forEach(function(e){e.UG_CreatorID===sessionStorage.getItem("userId")?a.createGroup.push({groupName:e.UG_Name,groupId:e.UGU_GroupID,groupNick:e.UGU_GroupNick,groupIntro:e.UG_Intro,groupIcon:e.UG_Icon,groupCreateTime:e.UG_CreateTime,groupAdminId:e.UG_AdminID,groupCreaterId:e.UG_CreaterID}):a.joinGroup.push({groupName:e.UG_Name,groupId:e.UGU_GroupID,groupNick:e.UGU_GroupNick,groupIntro:e.UG_Intro,groupIcon:e.UG_Icon,groupCreateTime:e.UG_CreateTime,groupAdminId:e.UG_AdminID,groupCreaterId:e.UG_CreaterID})}),s[1].data.data.forEach(function(e){a.requestGroup.push(JSON.parse(e.UM_Remark))}),e.groupsList=a,""!==e.$store.state.myGroupCheckedId&&(a.createGroup.every(function(t){return t.groupId!==e.$store.state.myGroupCheckedId})||a.joinGroup.every(function(t){return t.groupId!==e.$store.state.myGroupCheckedId}))&&(e.$store.state.myGroupCheckedId=""),t()}})})}},watch:{socket:{handler:function(e,t){var s=this;e&&!1===this.isSocketListen&&(e.on("refreshGroup",function(e){s.getAllGroups()}),this.isSocketListen=!0)},deep:!0}},components:{aMessage:E,headPortrait:c,createGroupDialog:ie,groupDetailDialog:de,searchGroupsDialog:s("Z0/y")(ce,le,!1,function(e){s("9hU/")},null,null).exports,friendDetailDialog:H,chatWindow:J}},pe={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"myGroups"},[s("createGroupDialog",{attrs:{dialogFlag:e.createGroupFlag},on:{"update:dialogFlag":function(t){e.createGroupFlag=t}}}),e._v(" "),s("groupDetailDialog",{attrs:{dialogFlag:e.groupDetailFlag,openData:e.groupDetailData,groupsList:e.groupsList},on:{"update:dialogFlag":function(t){e.groupDetailFlag=t}}}),e._v(" "),s("searchGroupsDialog",{attrs:{dialogFlag:e.searchGroupsFlag,groupsList:e.groupsList},on:{"update:dialogFlag":function(t){e.searchGroupsFlag=t}}}),e._v(" "),s("friendDetailDialog",{attrs:{dialogFlag:e.friendDetailFlag,openData:e.friendDetailData},on:{"update:dialogFlag":function(t){e.friendDetailFlag=t}}}),e._v(" "),s("el-container",[s("el-aside",{attrs:{width:"200px"}},[s("div",{staticClass:"operate"},[s("i",{staticClass:"el-icon-plus fr",on:{click:function(t){e.searchGroupsFlag=!0}}})]),e._v(" "),s("div",{staticClass:"search-wrap"},[s("el-input",{attrs:{maxlength:20,placeholder:"请输入群ID或群名进行搜索"},on:{focus:function(t){e.isFilterGroupShow=!0},blur:function(t){e.isFilterGroupShow=!1}},model:{value:e.searchParams,callback:function(t){e.searchParams=t},expression:"searchParams"}}),e._v(" "),s("ul",{class:{groupWrapHide:!e.isFilterGroupShow}},e._l(e.filterGroup,function(t){return s("li",{on:{click:function(s){e.goToGroup(t)}}},[s("headPortrait",{class:"group"+t.groupId,attrs:{isSave:!0,imgUrl:t.groupIcon,indexPath:t.groupId},on:{imgClick:e.imgClick}}),e._v(" "),s("span",{attrs:{title:t.groupName}},[e._v(e._s(t.groupName))])],1)}))],1),e._v(" "),s("div",{staticClass:"create-group",on:{click:function(t){e.createGroupFlag=!0}}},[s("i",{staticClass:"el-icon-plus"}),e._v(" "),s("span",[e._v("创建群")])]),e._v(" "),s("div",{staticClass:"my-group"},[s("el-menu",{ref:"groupMenu",staticClass:"el-menu-vertical-demo",attrs:{"background-color":"#545c64","text-color":"#fff","active-text-color":"#ffd04b"},on:{select:e.select}},[s("el-submenu",{attrs:{index:"0"}},[s("template",{slot:"title"},[s("span",[e._v("我创建的群")])]),e._v(" "),e._l(e.groupsList.createGroup,function(t,a){return s("el-menu-item",{key:a,attrs:{index:t.groupId}},[s("div",[s("headPortrait",{class:"group"+t.groupId,attrs:{imgUrl:t.groupIcon,indexPath:t.groupId},on:{imgClick:e.imgClick}}),e._v(" "),s("span",{class:{isActive:t.groupId===e.$store.state.myGroupCheckedId},attrs:{title:t.groupName}},[e._v(e._s(t.groupName))])],1)])})],2),e._v(" "),s("el-submenu",{attrs:{index:"1"}},[s("template",{slot:"title"},[s("span",[e._v("我加入的群")])]),e._v(" "),e._l(e.groupsList.joinGroup,function(t,a){return s("el-menu-item",{key:a,attrs:{index:t.groupId}},[s("div",[s("headPortrait",{class:"group"+t.groupId,attrs:{imgUrl:t.groupIcon,indexPath:t.groupId},on:{imgClick:e.imgClick}}),e._v(" "),s("span",{class:{isActive:t.groupId===e.$store.state.myGroupCheckedId}},[e._v(e._s(t.groupName))])],1)])})],2)],1)],1)]),e._v(" "),""!==e.$store.state.myGroupCheckedId?s("chatWindow",{attrs:{chatId:e.$store.state.myGroupCheckedId,chatType:2}}):e._e()],1)],1)},staticRenderFns:[]};var me=s("Z0/y")(ue,pe,!1,function(e){s("FqrP")},null,null).exports,ge={props:["value","reg","max","min"],data:function(){return{oldVal:this.value}},methods:{updateValue:function(e){var t=e.value;this.getResult(t)?(this.oldVal=t,t<this.min&&(e.value=this.oldVal=this.min),t>this.max&&(e.value=this.oldVal=this.max)):e.value=this.oldVal,this.$emit("input",this.oldVal)},blur:function(e){this.$emit("blur",e)},keyup:function(e){this.$emit("keyup",e)},getResult:function(e){if(!this.reg)return!0;if(this.reg.constructor==RegExp)return this.reg.test(e);if(this.reg.constructor==Array||this.reg.constructor==Object){for(var t in this.reg)if(!this.reg[t].test(e))return!1;return!0}return!0}}},he={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"el-input"},[s("input",{staticClass:"el-input__inner",attrs:{type:"text"},domProps:{value:e.value},on:{input:function(t){e.updateValue(t.target)},blur:e.blur,keyup:e.keyup}})])},staticRenderFns:[]},fe={name:"baseSetting",props:["data"],data:function(){return{userBaseData:{nickName:"",sex:0,birthday:"",age:"",name:"",email:"",phone:""}}},mounted:function(){},methods:{picUpdateSuccess:function(e,t){var s=this;this.$refs.uploadPic.clearFiles(),Array.prototype.forEach.call(this.$root.$el.getElementsByClassName("yourHead"),function(e,t){e.src="http://"+s.$store.state.statisFileIp+"/headProtrait/"+s.$store.state.userId+".jpg?time="+(new Date).getTime()})},getAge:function(e){this.userBaseData.age=e},getPhone:function(e){this.userBaseData.phone=e},save:function(){var e=this;this.$http.post("/updateUserInfo.do",{userId:sessionStorage.getItem("userId"),nickName:this.userBaseData.nickName,sex:this.userBaseData.sex,birthday:["",null].includes(this.userBaseData.birthday)?"":this.userBaseData.birthday.getTime(),age:this.userBaseData.age,name:this.userBaseData.name,email:this.userBaseData.email,phone:this.userBaseData.phone}).then(function(t){t.data.success&&(e.$message({message:"个人信息修改成功",type:"success"}),e.$store.state.nickName=""===e.userBaseData.nickName?null:e.userBaseData.nickName)})}},watch:{data:{handler:function(e){this.userBaseData={nickName:e.nickName,sex:e.sex,birthday:new Date(parseInt(e.birthday)),age:e.age,name:e.name,email:e.email,phone:e.phone}},deep:!0}},components:{numberValidator:s("Z0/y")(ge,he,!1,null,null,null).exports,headPortrait:c}},ve={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"baseSetting"},[s("div",{staticClass:"left"},[s("div",[s("headPortrait",{attrs:{userId:e.$store.state.userId}})],1),e._v(" "),s("el-upload",{ref:"uploadPic",attrs:{action:"/changeHeadPortrait.do?userId="+e.$store.state.userId,"on-success":e.picUpdateSuccess,limit:1}},[s("a",{attrs:{href:"javascript:;"}},[e._v("更换头像")])]),e._v(" "),s("div",[s("p",[e._v("ID:"+e._s(e.$store.state.userId))])])],1),e._v(" "),s("div",{staticClass:"right"},[s("el-row",[s("el-col",{attrs:{span:4}},[s("label",{attrs:{for:"nickName"}},[e._v("昵称:")])]),e._v(" "),s("el-col",{attrs:{span:6}},[s("el-input",{attrs:{id:"nickName"},model:{value:e.userBaseData.nickName,callback:function(t){e.$set(e.userBaseData,"nickName",t)},expression:"userBaseData.nickName"}})],1)],1),e._v(" "),s("el-row",[s("el-col",{attrs:{span:4}},[s("label",[e._v("性别:")])]),e._v(" "),s("el-col",{attrs:{span:6}},[s("el-radio",{attrs:{label:"1"},model:{value:e.userBaseData.sex,callback:function(t){e.$set(e.userBaseData,"sex",t)},expression:"userBaseData.sex"}},[e._v("男")]),e._v(" "),s("el-radio",{attrs:{label:"2"},model:{value:e.userBaseData.sex,callback:function(t){e.$set(e.userBaseData,"sex",t)},expression:"userBaseData.sex"}},[e._v("女")])],1)],1),e._v(" "),s("el-row",[s("el-col",{attrs:{span:4}},[s("label",{attrs:{for:"age"}},[e._v("年龄:")])]),e._v(" "),s("el-col",{attrs:{span:6}},[s("numberValidator",{attrs:{value:e.userBaseData.age,reg:/^\d*$/},on:{input:e.getAge}})],1)],1),e._v(" "),s("el-row",[s("el-col",{attrs:{span:4}},[s("label",{attrs:{for:"birthday"}},[e._v("生日:")])]),e._v(" "),s("el-col",{attrs:{span:6}},[s("el-date-picker",{attrs:{type:"date",placeholder:"选择日期"},model:{value:e.userBaseData.birthday,callback:function(t){e.$set(e.userBaseData,"birthday",t)},expression:"userBaseData.birthday"}})],1)],1),e._v(" "),s("el-row",[s("el-col",{attrs:{span:4}},[s("label",{attrs:{for:"phone"}},[e._v("手机:")])]),e._v(" "),s("el-col",{attrs:{span:6}},[s("numberValidator",{attrs:{value:e.userBaseData.phone,reg:/^\d*$/},on:{input:e.getPhone}})],1)],1),e._v(" "),s("el-row",[s("el-col",{attrs:{span:4}},[s("label",{attrs:{for:"name"}},[e._v("真实姓名:")])]),e._v(" "),s("el-col",{attrs:{span:6}},[s("el-input",{attrs:{id:"name"},model:{value:e.userBaseData.name,callback:function(t){e.$set(e.userBaseData,"name",t)},expression:"userBaseData.name"}})],1)],1),e._v(" "),s("el-row",[s("el-col",{attrs:{span:4}},[s("label",{attrs:{for:"email"}},[e._v("邮箱:")])]),e._v(" "),s("el-col",{attrs:{span:6}},[s("el-input",{attrs:{id:"email"},model:{value:e.userBaseData.email,callback:function(t){e.$set(e.userBaseData,"email",t)},expression:"userBaseData.email"}})],1)],1),e._v(" "),s("el-row",[s("el-col",{attrs:{span:10}},[s("el-button",{attrs:{type:"primary"},on:{click:e.save}},[e._v("保存")])],1)],1)],1)])},staticRenderFns:[]};var Ie={name:"changePassword",data:function(){return{oldPassword:"",newPassword:"",confirmPassword:"",oldPasswordTip:"",newPasswordTip:"",confirmPasswordTip:""}},methods:{checkConfirmPassword:function(){""!==this.confirmPassword?""===this.newPassword||this.newPassword===this.confirmPassword?this.confirmPasswordTip="":this.confirmPasswordTip="密码不一致":this.confirmPasswordTip="密码不能为空"},checkNewPassword:function(){""!==this.newPassword?""===this.confirmPassword||this.newPassword===this.confirmPassword?this.newPasswordTip="":this.newPasswordTip="密码不一致":this.newPasswordTip="密码不能为空"},confirm:function(){var e=this;""===this.newPasswordTip&&""===this.confirmPasswordTip&&""!==this.newPassword&&""!==this.confirmPassword&&this.confirmPassword===this.newPassword&&this.$http.post("/changePassword.do",{userId:sessionStorage.getItem("userId"),password:this.oldPassword,newPassword:this.confirmPassword}).then(function(t){t.data.success&&(t.data.msg?e.oldPasswordTip=t.data.msg:(e.oldPasswordTip="",e.oldPassword="",e.newPassword="",e.confirmPassword="",e.$message({message:"密码修改成功",type:"success"})))})}}},_e={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"changePassword"},[s("el-row",[s("el-col",{attrs:{span:4}},[s("label",{attrs:{for:"old-password"}},[e._v("原密码:")])]),e._v(" "),s("el-col",{attrs:{span:6}},[s("el-input",{attrs:{id:"old-password"},model:{value:e.oldPassword,callback:function(t){e.oldPassword=t},expression:"oldPassword"}})],1)],1),e._v(" "),s("el-row",[s("el-col",{attrs:{span:6,offset:4}},[""!==e.oldPasswordTip?s("el-alert",{attrs:{title:e.oldPasswordTip,closable:!1,type:"error"}}):e._e()],1)],1),e._v(" "),s("el-row",[s("el-col",{attrs:{span:4}},[s("label",{attrs:{for:"new-password"}},[e._v("新密码:")])]),e._v(" "),s("el-col",{attrs:{span:6}},[s("el-input",{attrs:{id:"new-password"},on:{blur:e.checkNewPassword},model:{value:e.newPassword,callback:function(t){e.newPassword=t},expression:"newPassword"}})],1)],1),e._v(" "),s("el-row",[s("el-col",{attrs:{span:6,offset:4}},[""!==e.newPasswordTip?s("el-alert",{attrs:{title:e.newPasswordTip,closable:!1,type:"error"}}):e._e()],1)],1),e._v(" "),s("el-row",[s("el-col",{attrs:{span:4}},[s("label",{attrs:{for:"confirm-password"}},[e._v("确认密码:")])]),e._v(" "),s("el-col",{attrs:{span:6}},[s("el-input",{attrs:{id:"confirm-password"},on:{blur:e.checkConfirmPassword},model:{value:e.confirmPassword,callback:function(t){e.confirmPassword=t},expression:"confirmPassword"}})],1)],1),e._v(" "),s("el-row",[s("el-col",{attrs:{span:6,offset:4}},[""!==e.confirmPasswordTip?s("el-alert",{attrs:{title:e.confirmPasswordTip,closable:!1,type:"error"}}):e._e()],1)],1),e._v(" "),s("el-row",[s("el-col",{attrs:{span:10}},[s("el-button",{attrs:{type:"primary"},on:{click:e.confirm}},[e._v("确定")])],1)],1)],1)},staticRenderFns:[]};var ke={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"friendPolicy"},[s("el-row",[s("el-col",{attrs:{span:4}},[s("el-tooltip",{attrs:{effect:"dark",content:"设置该策略他人能直接加您为好友",placement:"bottom-start"}},[s("el-radio",{attrs:{label:0},on:{change:e.changeFriendPolicy},model:{value:e.friendPolicyType,callback:function(t){e.friendPolicyType=t},expression:"friendPolicyType"}},[e._v("策略1")])],1)],1),e._v(" "),s("el-col",{attrs:{span:8,offset:1}},[s("p",[e._v("无")])])],1),e._v(" "),s("el-row",[s("el-col",{attrs:{span:4}},[s("el-tooltip",{attrs:{effect:"dark",content:"设置该策略他人输入正确密码后可以直接加您为好友",placement:"bottom-start"}},[s("el-radio",{attrs:{label:1},on:{change:e.changeFriendPolicy},model:{value:e.friendPolicyType,callback:function(t){e.friendPolicyType=t},expression:"friendPolicyType"}},[e._v("策略2")])],1)],1),e._v(" "),s("el-col",{attrs:{span:8,offset:1}},[s("label",{attrs:{for:"proving-password"}},[e._v("验证密码:")]),e._v(" "),s("el-input",{attrs:{id:"proving-password"},model:{value:e.provingPassword,callback:function(t){e.provingPassword=t},expression:"provingPassword"}})],1)],1),e._v(" "),s("el-row",[s("el-col",{attrs:{span:4}},[s("el-tooltip",{attrs:{effect:"dark",content:"设置该策略他人将根据问题填写答案，你将接收到好友验证选择是否通过",placement:"bottom-start"}},[s("el-radio",{attrs:{label:2},on:{change:e.changeFriendPolicy},model:{value:e.friendPolicyType,callback:function(t){e.friendPolicyType=t},expression:"friendPolicyType"}},[e._v("策略3")])],1)],1),e._v(" "),s("el-col",{attrs:{span:8,offset:1}},[s("label",{attrs:{for:"proving-qusetion"}},[e._v("验证问题:")]),e._v(" "),s("el-input",{attrs:{id:"proving-qusetion"},model:{value:e.provingQuesttion,callback:function(t){e.provingQuesttion=t},expression:"provingQuesttion"}})],1)],1)],1)},staticRenderFns:[]};var ye={name:"informationPushSetting",data:function(){return{friendLoginPush:-1!==sessionStorage.getItem("messagePush").indexOf("1"),friendMessagePush:-1!==sessionStorage.getItem("messagePush").indexOf("2")}},methods:{friendLoginPushChange:function(){var e=this,t=this.$store.state.messagePush.split(",");if(-1!==t.findIndex(function(e){return""==e})&&t.splice(t.findIndex(function(e){return""==e}),1),this.friendLoginPush)!t.includes("1")&&t.push("1");else{t.findIndex(function(e){return"1"==e});t.includes("1")&&t.splice(t.findIndex(function(e){return"1"==e}),1)}var s=t.join(",");this.$http.post("/updateUserInfo.do",{userId:this.$store.state.userId,messagePush:s}).then(function(t){t.data.success&&(e.$message({message:"修改成功",type:"success"}),sessionStorage.setItem("messagePush",s),e.$store.state.messagePush=s)})},friendMessagePushChange:function(){var e=this,t=this.$store.state.messagePush.split(",");-1!==t.findIndex(function(e){return""==e})&&t.splice(t.findIndex(function(e){return""==e}),1),this.friendMessagePush?!t.includes("2")&&t.push("2"):t.includes("2")&&t.splice(t.findIndex(function(e){return"2"==e}),1);var s=t.join(",");this.$http.post("/updateUserInfo.do",{userId:this.$store.state.userId,messagePush:s}).then(function(t){t.data.success&&(e.$message({message:"修改成功",type:"success"}),sessionStorage.setItem("messagePush",s),e.$store.state.messagePush=s)})}}},we={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"informationPushSetting"},[s("el-row",[s("el-col",{attrs:{span:4}},[s("label",[e._v("好友上线推送")])]),e._v(" "),s("el-col",{attrs:{span:4}},[s("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},on:{change:e.friendLoginPushChange},model:{value:e.friendLoginPush,callback:function(t){e.friendLoginPush=t},expression:"friendLoginPush"}})],1)],1),e._v(" "),s("el-row",[s("el-col",{attrs:{span:4}},[s("label",[e._v("好友信息推送")])]),e._v(" "),s("el-col",{attrs:{span:4}},[s("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},on:{change:e.friendMessagePushChange},model:{value:e.friendMessagePush,callback:function(t){e.friendMessagePush=t},expression:"friendMessagePush"}})],1)],1)],1)},staticRenderFns:[]};var $e={name:"personal",data:function(){return{baseData:{},policyData:{}}},mounted:function(){this.getUserInfo()},methods:{getUserInfo:function(){var e=this;this.$http.post("/getUserInfo.do",{userId:sessionStorage.getItem("userId")}).then(function(t){t.data.success&&(e.baseData={nickName:t.data.data[0].U_NickName,age:t.data.data[0].U_Age,birthday:t.data.data[0].U_Birthday,phone:t.data.data[0].U_Telephone,email:t.data.data[0].U_Email,name:t.data.data[0].U_Name,sex:t.data.data[0].U_Sex},e.policyData={friendPolicyType:t.data.data[0].U_FriendshipPolicyID,provingPassword:t.data.data[0].U_FriendPolicyPassword,provingQuesttion:t.data.data[0].U_FriendPolicyQuestion})})}},components:{baseSetting:s("Z0/y")(fe,ve,!1,function(e){s("uT0V")},null,null).exports,changePassword:s("Z0/y")(Ie,_e,!1,function(e){s("t/tJ")},null,null).exports,friendPolicy:s("Z0/y")({name:"friendPolicy",props:["data"],data:function(){return{friendPolicyType:0,provingPassword:"",provingQuesttion:""}},mounted:function(){},methods:{changeFriendPolicy:function(){1!==this.friendPolicyType||""!==this.provingPassword?2!==this.friendPolicyType||""!==this.provingQuesttion?this.$http.post("/updateUserInfo.do",{userId:this.$store.state.userId,friendPolicyId:this.friendPolicyType,friendPolicyQuestion:""===this.provingQuesttion?null:this.provingQuesttion,friendPolicyPassword:""===this.provingPassword?null:this.provingPassword}).then(function(e){e.data.success}):this.$message.error("问题不能为空"):this.$message.error("密码不能为空")}},watch:{data:{handler:function(){this.friendPolicyType=this.data.friendPolicyType||0,this.provingPassword=this.data.provingPassword||"",this.provingQuesttion=this.data.provingQuesttion||""},deep:!0}}},ke,!1,function(e){s("o+5A")},null,null).exports,informationPushSetting:s("Z0/y")(ye,we,!1,function(e){s("ltVu")},null,null).exports}},De={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"personal"},[t("el-tabs",{staticStyle:{height:"200px"},attrs:{"tab-position":"left"}},[t("el-tab-pane",{attrs:{label:"基本资料"}},[t("baseSetting",{attrs:{data:this.baseData}})],1),this._v(" "),t("el-tab-pane",{attrs:{label:"修改密码"}},[t("changePassword")],1),this._v(" "),t("el-tab-pane",{attrs:{label:"好友策略"}},[t("friendPolicy",{attrs:{data:this.policyData}})],1),this._v(" "),t("el-tab-pane",{attrs:{label:"消息推送设置"}},[t("informationPushSetting")],1)],1)],1)},staticRenderFns:[]};var be=s("Z0/y")($e,De,!1,function(e){s("NQZv")},null,null).exports,Fe={name:"remind",props:["data","index","isChecked"],data:function(){return{groupIcon:null,detailData:{}}},mounted:function(){this.init()},methods:{init:function(){var e=this;"1"===this.data.messageType&&"group"===this.data.remark&&this.$http.post("/getGroupDetailData.do",{groupId:this.data.fromId}).then(function(t){t.data.success&&(t.data.data[0]?e.groupIcon=t.data.data[0].UG_Icon:e.groupIcon="none")})},imgClick:function(e){for(var t=this.$parent;"myMessage"!==t.$el.className;)t=t.$parent;"group"===this.data.remark?(console.log(this.$parent),t.getGroupDetail(e)):t.getUserInfo(e)},messageCheck:function(){this.$emit("messageCheck",this.index)},deleteRemind:function(){this.$emit("deleteRemind",this.index)}},watch:{data:{handler:function(){this.init()},deep:!0}},components:{headPortrait:c}},Ne={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{class:{remind:!0,checked:e.isChecked},on:{click:e.messageCheck}},["0"===e.data.isRead&&e.data.tipNum&&!e.isChecked?s("span",{staticClass:"new"},[e._v("new")]):e._e(),e._v(" "),s("i",{staticClass:"el-icon-close",on:{click:function(t){return t.stopPropagation(),e.deleteRemind(t)}}}),e._v(" "),"1"===e.data.messageType?s("div",{staticClass:"chatObj"},[e.data.tipNum&&"0"===e.data.isRead&&!e.isChecked?s("el-badge",{staticClass:"item",attrs:{value:e.data.tipNum}},[s("span",[e._v("1")])]):e._e(),e._v(" "),"group"===e.data.remark&&e.groupIcon?s("headPortrait",{attrs:{imgUrl:e.groupIcon,indexPath:e.data.fromId},on:{imgClick:e.imgClick}}):e._e(),e._v(" "),"friend"===e.data.remark?s("headPortrait",{attrs:{indexPath:e.data.fromId,userId:e.data.fromId},on:{imgClick:e.imgClick}}):e._e(),e._v(" "),s("span",{staticClass:"remindObjName"},[e._v(e._s(e.data.fromName||e.data.fromId))])],1):e._e(),e._v(" "),"2"===e.data.messageType?s("div",{staticClass:"remindTip"},[s("p",[e._v("你收到一条好友请求！")]),e._v(" "),s("p",{staticClass:"name"},[e._v("from:"+e._s(e.data.fromName||e.data.fromId))])]):e._e(),e._v(" "),"3"===e.data.messageType?s("div",{staticClass:"remindTip"},[s("p",[e._v("你又多了一位新朋友！")]),e._v(" "),s("p",{staticClass:"name"},[e._v("from:"+e._s(e.data.fromName||e.data.fromId))])]):e._e(),e._v(" "),"4"===e.data.messageType?s("div",{staticClass:"remindTip"},[s("p",[e._v("你被对方从好友中删除！")]),e._v(" "),s("p",{staticClass:"name"},[e._v("from:"+e._s(e.data.fromName||e.data.fromId))])]):e._e(),e._v(" "),"5"===e.data.messageType?s("div",{staticClass:"remindTip"},[s("p",[e._v("对方拒绝了你的好友邀请！")]),e._v(" "),s("p",{staticClass:"name"},[e._v("from:"+e._s(e.data.fromName||e.data.fromId))])]):e._e(),e._v(" "),"6"===e.data.messageType?s("div",{staticClass:"remindTip"},[s("p",[e._v("你收到一条群邀请！")]),e._v(" "),s("p",{staticClass:"name"},[e._v("from:"+e._s(e.data.fromName||e.data.fromId))])]):e._e(),e._v(" "),"7"===e.data.messageType?s("div",{staticClass:"remindTip"},[s("p",[e._v("对方拒绝了你的群邀请！")]),e._v(" "),s("p",{staticClass:"name"},[e._v("from:"+e._s(e.data.fromName||e.data.fromId))])]):e._e(),e._v(" "),"8"===e.data.messageType?s("div",{staticClass:"remindTip"},[s("p",[e._v("你收到一条群请求！")]),e._v(" "),s("p",{staticClass:"name"},[e._v("from:"+e._s(e.data.fromName||e.data.fromId))])]):e._e(),e._v(" "),"9"===e.data.messageType?s("div",{staticClass:"remindTip"},[s("p",[e._v("对方拒绝了你的群请求！")]),e._v(" "),s("p",{staticClass:"name"},[e._v("from:"+e._s(e.data.fromName||e.data.fromId))])]):e._e()])},staticRenderFns:[]};var Pe={name:"myMessage",data:function(){return{groupDetailFlag:!1,friendDetailFlag:!1,remindList:[],checkedIndex:"",groupDetailData:{},friendDetailData:{},isSocketListen:!1}},components:{remind:s("Z0/y")(Fe,Ne,!1,function(e){s("0xVi")},null,null).exports,groupDetailDialog:de,friendDetailDialog:H,chatWindow:J},created:function(){this.getAllRemind()},activated:function(){this.getAllRemind()},computed:{socket:function(){return this.$store.state.socket},tips:function(){return this.$store.state.remindTips}},methods:{getUserInfo:function(e){var t=this;this.$http.post("/getUserInfo.do",{userId:e}).then(function(e){e.data.success&&(t.friendDetailData={userId:e.data.data[0].U_LoginID,nickName:e.data.data[0].U_NickName,age:e.data.data[0].U_Age,birthday:e.data.data[0].U_Birthday,phone:e.data.data[0].U_Telephone,email:e.data.data[0].U_Email,name:e.data.data[0].U_Name,sex:e.data.data[0].U_Sex},t.friendDetailFlag=!0)})},getGroupDetail:function(e){var t=this;T.a.all([this.getGroupDetailData(e),this.getGroupMembers(e)]).then(function(e){if(e[0].data.success&&e[1].data.success){if(0===e[0].data.data.length)return void t.$message.error("该群不存在");t.groupDetailData={groupId:e[0].data.data[0].UG_ID,groupName:e[0].data.data[0].UG_Name,groupIntro:e[0].data.data[0].UG_Intro,groupNotice:e[0].data.data[0].UG_Notice,groupIcon:e[0].data.data[0].UG_Icon,createTime:e[0].data.data[0].UG_CreateTime,adminId:e[0].data.data[0].UG_AdminID,members:[]},e[1].data.data.forEach(function(e){t.groupDetailData.members.push({groupNick:e.UGU_GroupNick,memberId:e.UGU_UserID,joinTime:e.UGU_CreateTime,authority:e.UGU_Authority})}),t.groupDetailFlag=!0}})},getGroupDetailData:function(e){return this.$http.post("/getGroupDetailData.do",{groupId:e})},getGroupMembers:function(e){return this.$http.post("/getGroupMembers.do",{groupId:e})},joinGroup:function(){var e=this,t={groupId:this.remindList[this.checkedIndex].remark.groupId,fromId:this.remindList[this.checkedIndex].fromId,messageType:this.remindList[this.checkedIndex].messageType};"8"==t.messageType?(t.userId=this.remindList[this.checkedIndex].fromId,t.nickName=this.remindList[this.checkedIndex].fromName):(t.userId=this.$store.state.userId,t.nickName=this.$store.state.nickName),this.$http.post("/joinGroup2.do",t).then(function(s){s.data.success&&(e.$message({message:"成功加群",type:"success"}),e.$store.state.socket.emit("sendRemind",{toId:e.remindList[e.checkedIndex].fromId}),"8"==t.messageType&&e.$store.state.socket.emit("refreshGroup",{toId:e.remindList[e.checkedIndex].fromId}),e.checkedIndex="",e.getAllRemind())})},messageCheck:function(e){this.checkedIndex!==e&&(this.checkedIndex=e,"0"===this.remindList[e].isRead&&(this.$http.post("/readRemind.do",{id:this.remindList[e].id,userId:this.$store.state.userId,type:"1"===this.remindList[e].messageType?"1":"2"}).then(function(e){}),this.remindList[e].isRead=1,this.$store.state.remindTips=this.$store.state.remindTips-this.remindList[e].tipNum))},deleteRemind:function(e){var t=this;this.$http.post("/deleteRemind.do",{id:this.remindList[e].id}).then(function(e){if(e.data.success){var s=void 0;""!==t.checkedIndex&&(s=t.remindList[t.checkedIndex].id),t.checkedIndex="",t.getAllRemind().then(function(){if(void 0!==s){var e=t.remindList.findIndex(function(e){return e.id===s});t.checkedIndex=-1===e?"":e}})}})},rejectRequest:function(){var e=this,t={fromName:this.$store.state.nickName,toId:sessionStorage.getItem("userId"),fromId:this.remindList[this.checkedIndex].fromId,id:this.remindList[this.checkedIndex].id,messageType:this.remindList[this.checkedIndex].messageType};"8"==t.messageType&&(t.groupId=this.remindList[this.checkedIndex].remark.groupId),this.$http.post("/rejectRequest.do",t).then(function(t){t.data.success&&(e.$message({message:"已拒绝",type:"success"}),e.$store.state.socket.emit("sendRemind",{toId:e.remindList[e.checkedIndex].fromId}),e.checkedIndex="",e.getAllRemind())})},addFriend:function(){var e=this;this.$http.post("/addFriend.do",{userId:sessionStorage.getItem("userId"),userName:this.$store.state.nickName,friendId:this.remindList[this.checkedIndex].fromId}).then(function(t){t.data.success&&("添加成功"===t.data.msg?(e.$message({message:t.data.msg,type:"success"}),e.$http.post("/deleteRemind.do",{id:e.remindList[e.checkedIndex].id}).then(function(t){t.data.success&&(e.$store.state.socket.emit("sendRemind",{toId:e.remindList[e.checkedIndex].fromId}),e.$store.state.socket.emit("refreshFriend",{toId:e.remindList[e.checkedIndex].fromId}),e.checkedIndex="",e.getAllRemind())})):e.$message.error(t.data.msg))})},getAllRemind:function(){var e=this;return new T.a(function(t){e.$http.post("/getAllRemind.do",{userId:sessionStorage.getItem("userId")}).then(function(s){if(s.data.success){var a=[],r=0;s.data.data.forEach(function(e){a.push({fromId:e.UM_FromID,fromName:e.UM_FromName,message:e.UM_Message,isRead:e.UM_IsRead,time:v(parseInt(e.UM_Time),"yyyy-MM-dd HH:mm"),messageType:e.UM_MessageType,remark:["6","7","8","9"].includes(e.UM_MessageType)?JSON.parse(e.UM_Remark):e.UM_Remark,id:e.UM_ID,tipNum:e.UM_TipNum}),"0"===e.UM_IsRead&&(r+=e.UM_TipNum)}),e.$store.state.remindTips=r,e.remindList=a,t()}})})}},watch:{socket:function(e){var t=this;e&&!1===this.isSocketListen&&(e.on("RefreshRemind",function(){t.getAllRemind()}),this.isSocketListen=!0)},tips:function(){this.getAllRemind()}}},xe={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"myMessage"},[s("groupDetailDialog",{attrs:{dialogFlag:e.groupDetailFlag,openData:e.groupDetailData},on:{"update:dialogFlag":function(t){e.groupDetailFlag=t}}}),e._v(" "),s("friendDetailDialog",{attrs:{dialogFlag:e.friendDetailFlag,openData:e.friendDetailData},on:{"update:dialogFlag":function(t){e.friendDetailFlag=t}}}),e._v(" "),s("el-container",[s("el-aside",{attrs:{width:"200px"}},[s("div",{staticClass:"message-group"},e._l(e.remindList,function(t,a){return s("remind",{key:a,attrs:{data:t,index:a,isChecked:e.checkedIndex===a},on:{messageCheck:e.messageCheck,deleteRemind:e.deleteRemind}})}))]),e._v(" "),s("el-container",[""!==e.checkedIndex?s("div",{staticClass:"detail"},["1"===e.remindList[e.checkedIndex].messageType?s("chatWindow",{attrs:{chatId:e.remindList[e.checkedIndex].fromId,chatType:"friend"===e.remindList[e.checkedIndex].remark?1:2}}):e._e(),e._v(" "),"2"===e.remindList[e.checkedIndex].messageType?s("div",{staticClass:"proving"},[s("p",[s("span",{on:{click:function(t){e.getUserInfo(e.remindList[e.checkedIndex].fromId)}}},[e._v(e._s(e.remindList[e.checkedIndex].fromName||e.remindList[e.checkedIndex].fromId))]),e._v("向您发来好友验证:")]),e._v(" "),s("p",{staticClass:"question"},[e._v("您的问题:"+e._s(e.remindList[e.checkedIndex].remark))]),e._v(" "),s("p",{staticClass:"answer"},[e._v("对方回答:"+e._s(e.remindList[e.checkedIndex].message))]),e._v(" "),s("p",{staticClass:"time"},[e._v("日期:"+e._s(e.remindList[e.checkedIndex].time))]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:e.addFriend}},[e._v("同意")]),e._v(" "),s("el-button",{attrs:{type:"danger"},on:{click:e.rejectRequest}},[e._v("拒绝")])],1):e._e(),e._v(" "),"3"===e.remindList[e.checkedIndex].messageType?s("div",{staticClass:"proving"},[s("p",[s("span",{on:{click:function(t){e.getUserInfo(e.remindList[e.checkedIndex].fromId)}}},[e._v(e._s(e.remindList[e.checkedIndex].fromName||e.remindList[e.checkedIndex].fromId))]),e._v("与你已成为好友")]),e._v(" "),s("p",{staticClass:"time"},[e._v("日期:"+e._s(e.remindList[e.checkedIndex].time))])]):e._e(),e._v(" "),"4"===e.remindList[e.checkedIndex].messageType?s("div",{staticClass:"proving"},[s("p",[s("span",{on:{click:function(t){e.getUserInfo(e.remindList[e.checkedIndex].fromId)}}},[e._v(e._s(e.remindList[e.checkedIndex].fromName||e.remindList[e.checkedIndex].fromId))]),e._v("与你已解除好友关系")]),e._v(" "),s("p",{staticClass:"time"},[e._v("日期:"+e._s(e.remindList[e.checkedIndex].time))])]):e._e(),e._v(" "),"5"===e.remindList[e.checkedIndex].messageType?s("div",{staticClass:"proving"},[s("p",[s("span",{on:{click:function(t){e.getUserInfo(e.remindList[e.checkedIndex].fromId)}}},[e._v(e._s(e.remindList[e.checkedIndex].fromName||e.remindList[e.checkedIndex].fromId))]),e._v("拒绝了你的好友邀请:")]),e._v(" "),s("p",{staticClass:"question"},[e._v("对方的问题:"+e._s(e.remindList[e.checkedIndex].remark))]),e._v(" "),s("p",{staticClass:"answer"},[e._v("您回答:"+e._s(e.remindList[e.checkedIndex].message))]),e._v(" "),s("p",{staticClass:"time"},[e._v("日期:"+e._s(e.remindList[e.checkedIndex].time))])]):e._e(),e._v(" "),"6"===e.remindList[e.checkedIndex].messageType?s("div",{staticClass:"proving"},[s("p",[s("span",{on:{click:function(t){e.getUserInfo(e.remindList[e.checkedIndex].fromId)}}},[e._v(e._s(e.remindList[e.checkedIndex].fromName||e.remindList[e.checkedIndex].fromId))]),e._v("邀你加入群:"),s("span",{on:{click:function(t){e.getGroupDetail(e.remindList[e.checkedIndex].remark.groupId)}}},[e._v(e._s(e.remindList[e.checkedIndex].remark.groupName))])]),e._v(" "),s("p",{staticClass:"time"},[e._v("日期:"+e._s(e.remindList[e.checkedIndex].time))]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:e.joinGroup}},[e._v("同意")]),e._v(" "),s("el-button",{attrs:{type:"danger"},on:{click:e.rejectRequest}},[e._v("拒绝")])],1):e._e(),e._v(" "),"7"===e.remindList[e.checkedIndex].messageType?s("div",{staticClass:"proving"},[s("p",[s("span",{on:{click:function(t){e.getUserInfo(e.remindList[e.checkedIndex].fromId)}}},[e._v(e._s(e.remindList[e.checkedIndex].fromName||e.remindList[e.checkedIndex].fromId))]),e._v("拒绝了关于其加入群:"),s("span",{on:{click:function(t){e.getGroupDetail(e.remindList[e.checkedIndex].remark.groupId)}}},[e._v(e._s(e.remindList[e.checkedIndex].remark.groupName))]),e._v("的邀请\n          ")]),e._v(" "),s("p",{staticClass:"time"},[e._v("日期:"+e._s(e.remindList[e.checkedIndex].time))])]):e._e(),e._v(" "),"8"===e.remindList[e.checkedIndex].messageType?s("div",{staticClass:"proving"},[s("p",[s("span",{on:{click:function(t){e.getUserInfo(e.remindList[e.checkedIndex].fromId)}}},[e._v(e._s(e.remindList[e.checkedIndex].fromName||e.remindList[e.checkedIndex].fromId))]),e._v("请求入群:"),s("span",{on:{click:function(t){e.getGroupDetail(e.remindList[e.checkedIndex].remark.groupId)}}},[e._v(e._s(e.remindList[e.checkedIndex].remark.groupName))])]),e._v(" "),s("p",{staticClass:"time"},[e._v("日期:"+e._s(e.remindList[e.checkedIndex].time))]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:e.joinGroup}},[e._v("同意")]),e._v(" "),s("el-button",{attrs:{type:"danger"},on:{click:e.rejectRequest}},[e._v("拒绝")])],1):e._e(),e._v(" "),"9"===e.remindList[e.checkedIndex].messageType?s("div",{staticClass:"proving"},[s("p",[s("span",{on:{click:function(t){e.getUserInfo(e.remindList[e.checkedIndex].fromId)}}},[e._v(e._s(e.remindList[e.checkedIndex].fromName||e.remindList[e.checkedIndex].fromId))]),e._v("拒绝了关于你加入群:"),s("span",{on:{click:function(t){e.getGroupDetail(e.remindList[e.checkedIndex].remark.groupId)}}},[e._v(e._s(e.remindList[e.checkedIndex].remark.groupName))]),e._v("的请求\n          ")]),e._v(" "),s("p",{staticClass:"time"},[e._v("日期:"+e._s(e.remindList[e.checkedIndex].time))])]):e._e()],1):e._e()])],1)],1)},staticRenderFns:[]};var Ge=s("Z0/y")(Pe,xe,!1,function(e){s("PNnS")},null,null).exports;a.default.use(o.a);var Ce=new o.a({routes:[{path:"/",name:"login",redirect:"/login"},{path:"/login",name:"login",component:N},{path:"/register",name:"register",component:G},{path:"/home",name:"home",component:D,children:[{path:"/home/myFriend",name:"myFriend",component:se},{path:"/home/personal",name:"personal",component:be},{path:"/home/myMessage",name:"myMessage",component:Ge},{path:"/home/myGroups",name:"myGroups",component:me}]}]}),Te=s("9rMa"),Ue=s("JOg9"),Le=s.n(Ue);s("bTWF");a.default.use(f.a),a.default.use(Te.a);var Me=new Te.a.Store({mode:"history",state:{statisFileIp:"localhost:8081",isVideo:!1,nickName:null,userId:null,socket:null,pageSize:10,expressArr:[],remindTips:0,messagePush:"",myFriendCheckedId:"",myGroupCheckedId:""},mutations:{},actions:{connectSocket:function(e){e.state.socket=Le.a.connect(),e.state.socket.emit("login",this.state.userId),e.state.socket.on("loginSuccess",function(t){(new a.default).$message({message:"socket连接成功",type:"success"});var s=sessionStorage.getItem("messagePush");-1===s.indexOf("1")&&(console.log("好友上线推送关闭"),e.state.socket.removeAllListeners("friendLoginRemand"),e.state.socket.removeAllListeners("friendDisconnectRemand")),-1===s.indexOf("2")&&(console.log("好友消息推送关闭"),e.state.socket.removeAllListeners("getMessageToHead"))}),e.state.socket.on("friendLoginRemand",function(e){(new a.default).$notify({title:"tip",message:"你的好友"+e.name+"已上线",position:"bottom-right",duration:3e3})}),e.state.socket.on("friendDisconnectRemand",function(e){(new a.default).$notify({title:"tip",message:"你的好友"+e.name+"已下线",position:"bottom-right",duration:3e3})}),e.state.socket.on("sendError",function(){(new a.default).$message.error("发送失败")}),e.state.socket.on("sendSuccess",function(){(new a.default).$message.error("发送成功")})},socketDisconnect:function(e){e.state.socket.disconnect()},friendRemand:function(e,t){console.log("好友上线推送关闭"),e.state.socket.removeAllListeners("friendLoginRemand"),e.state.socket.removeAllListeners("friendDisconnectRemand"),t&&(console.log("好友上线推送开启"),e.state.socket.on("friendLoginRemand",function(e){(new a.default).$notify({title:"tip",message:"你的好友"+e.name+"已上线",position:"bottom-right",duration:3e3})}),e.state.socket.on("friendDisconnectRemand",function(e){(new a.default).$notify({title:"tip",message:"你的好友"+e.name+"已下线",position:"bottom-right",duration:3e3})}))}}}),Re=s("aozt"),Ae=s.n(Re);Ae.a.interceptors.response.use(function(e){return e.data.success||e.data.msg&&h.Message.error(e.data.msg),e});var Se=Ae.a;s("HBSQ"),s("r7R4");a.default.use(f.a),a.default.use(Te.a),a.default.prototype.$http=Se,a.default.config.productionTip=!1,new a.default({el:"#app",router:Ce,store:Me,components:{App:i},template:"<App/>"})},NQZv:function(e,t){},Olqw:function(e,t){},OmM3:function(e,t){},PNnS:function(e,t){},QZmy:function(e,t){},QxDx:function(e,t){},bIQm:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJYAAAA9CAYAAABP2pDPAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyBpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBXaW5kb3dzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOkRCMEQ0OTg3Mjc0NTExRThBNjFGQjIyRjNBQURFMUU1IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOkRCMEQ0OTg4Mjc0NTExRThBNjFGQjIyRjNBQURFMUU1Ij4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6REIwRDQ5ODUyNzQ1MTFFOEE2MUZCMjJGM0FBREUxRTUiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6REIwRDQ5ODYyNzQ1MTFFOEE2MUZCMjJGM0FBREUxRTUiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz58kfYtAAAFq0lEQVR42uyczXXbOBDH4X057C10BaEvuZquwEwFkSqIVIHlCkRVYKkCyRVYqUB0BeFeczG3goVve/MK7w3iWQTfZETEnP97eI4cCgSBH2YGA9BnLy8vjETqW2cEFonAIhFYJAKLeoFEYJEILBKBRSIRWCQCi0RgkUgEFonAIhFYJBKBRSKwSATWyfTvx4+/a5/lUKT4sTSpNvbP798Hue+7BAetOJbLYynh3+cJtGt2LJ+hTZnhmvpY7o9ldwKYWyhksTQWSweRbtDOBuwf0a6tMqguiQGfdrRimQIzs8D8FWDmKVmsIcHyubEYnCtL55cAptAzdHRfbmkGUMWIQ7vbCKBujmVhsYym+93qrOUYXWHtmI3MMAtL6PyJpd4V/IzVxAKVqHcDPzm6/gtqk4BieSzznqxji6DJ4D65AqRs744loCEt1sEDLDF4n5TBWnjeYh7ZyeI+TwaL4apTtK9Ck8I3PjRZxwZCBNwPUqIf7jQT8QJPyKEs1h8DQt0EDvYhACoGAzWJtFY6qPYaqAqAsIDPG6XNXaCagzvlqH6sNbg/tZ8mLAENCRYPhKqIuMc2MFYRujb8/l7zuwdwSbFxXWmACsdLe+UZcuiPpaHOD2MH62/POEyFagcz+QxcTeURDIcu7X0nQo7ckgpJ7TFhHgzPvEafH5F1xJaw0rhC335902D5rJgWqEM5xBlzZCE4BOprRx196NoAAYMBPihu6N5R353Bmq40LrhC/dVAP5xrXCGH6wksj1mNoTJZgY1HTqhr7LfQuONbw3NUjiA/t7TpBv4vUyYP10DENXEZTwGsobd0fG4uoXLFMU8WNyZm8TQg7jlY2jLVAJ6je/ukObaesNvara5etSvWMa4KfQP4W8/guHXA4qvaAodcSKhurHV8T7fy1GkK6QIJSeOwenKf8oolkr9KxWK5clkhlsZV11XA6k24vG8eIM9ZeCLWVvcFC8vWZ67JOVaL5dIm0grOwX1WyoCGxFmurLlc9j8EpjTyjnFnTMpmdGDVv6DOHZQagl5ppS4j6pl6DN4EYh3fxOQlG4FSt1gxiUdu+Fw4XMoCxU85csWfPOCSOaltT8+dsbiEMIEFevwFpn6GwChR3FVaXNMTAFUCYNgCNRD7NJ737pI3WwKg/wDkGYGVjiQoL5q0QWEYTN0A3mlSHj6u+84RRz1b/q9CQO8JrNO6ui4phSJg6Z8r10u4fDLbN5HPLFea5/CzJbDixHtcIcUGzqHu1mfAy0iwMmY5DUpg9WO12g6witWc3KTeOSzWztKuxpLOCLWM+PuNBayl8nnm6f5x0nbw4D8FsPqenTvkrrhiYXSdvdHETq0DnrqjRbXl5+SeZAEx4lYDW6nEX3JVK936Fr47GzNY7QlAbdEA5JrrRex0BcGzPGDniv/2HSbLzvLcGQKjgGtXyspTPUrUQH1L9nrKIhsyRnv3BsHKNQNVKG6q1biuJnAxwTsuSubMvNldIMuoWs73FiuKUy0x201vymI9WzoqRjOYuSXMXDUfpAbwWxaXM7Jd/9Xj++L51h6LgINh5XqNYjDV7cWe9+9NKbwJXRpmbsV+PvRmk++D1Oz1xQT88kPIhreQ7ZhOyGay7xEabOFzhyX8AdWYN6FPvbTGbhFn/uUrXz6Wa2EZ3HWge58z+/Fql6vHwCVzfCbldAProbNr6OgKrNQF+/8rWao7EpbjG7NvKOteu8LPsopo/wqgqCMnZsXCjgWNwhVKN9agHA8Ha1IHWKEbmLWPLPxvG+jcUasE9Dm47dwClc+Gtc+zfGGvf3bABFMNsdzeds8xvmLPEtMy0CV1iQdDQVNPq3pPGgIrDeUAmE8wLd+IWbGE9/QIrLQk3yi+ZD9vRAuX9xdL5DUrAos0KhFYJAKLRGCRCCwCi0RgkQgsEoFFIhFYJAKLRGCRSAQWKXn9J8AAZe/vg12Ay0kAAAAASUVORK5CYII="},bTWF:function(e,t){},"c/3I":function(e,t){},doAy:function(e,t){},ltVu:function(e,t){},"o+5A":function(e,t){},r7R4:function(e,t){},si95:function(e,t){},"t/tJ":function(e,t){},uT0V:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.fced258c39a7520ee741.js.map